/**
 * JavaScript for PHPMaker 2019
 * @license (C)2002-2018 e.World Technology Ltd.
 */
var currentPageID,currentForm,currentSearchForm,currentAdvancedSearchForm,$rowindex$=null;var ew={LANGUAGE_ID:"",PAGE_ID:"",DATE_SEPARATOR:"",TIME_SEPARATOR:"",DATE_FORMAT:"",DATE_FORMAT_ID:0,DATETIME_WITHOUT_SECONDS:false,DECIMAL_POINT:"",THOUSANDS_SEP:"",MIN_PASSWORD_STRENGTH:0,GENERATE_PASSWORD_LENGTH:0,GENERATE_PASSWORD_UPPERCASE:true,GENERATE_PASSWORD_LOWERCASE:true,GENERATE_PASSWORD_NUMBER:true,GENERATE_PASSWORD_SPECIALCHARS:false,SESSION_TIMEOUT:0,SESSION_TIMEOUT_COUNTDOWN:0,SESSION_KEEP_ALIVE_INTERVAL:0,RELATIVE_PATH:"",IS_LOGGEDIN:false,IS_SYS_ADMIN:false,CURRENT_USER_NAME:"",IS_AUTOLOGIN:false,TIMEOUT_URL:"",API_URL:"",API_ACTION_NAME:"",API_OBJECT_NAME:"",API_FIELD_NAME:"",API_KEY_NAME:"",API_LIST_ACTION:"",API_VIEW_ACTION:"",API_ADD_ACTION:"",API_EDIT_ACTION:"",API_DELETE_ACTION:"",API_LOGIN_ACTION:"",API_FILE_ACTION:"",API_UPLOAD_ACTION:"",API_JQUERY_UPLOAD_ACTION:"",API_SESSION_ACTION:"",API_LOOKUP_ACTION:"",API_LOOKUP_TABLE:"",API_PROGRESS_ACTION:"",LOOKUP_FILTER_VALUE_SEPARATOR:"",AUTO_SUGGEST_MAX_ENTRIES:0,MAX_EMAIL_RECIPIENT:0,DISABLE_BUTTON_ON_SUBMIT:false,IMAGE_FOLDER:"",UPLOAD_URL:"",UPLOAD_TYPE:"",UPLOAD_THUMBNAIL_WIDTH:0,UPLOAD_THUMBNAIL_HEIGHT:0,MULTIPLE_UPLOAD_SEPARATOR:"",IMPORT_FILE_ALLOWED_EXT:"",USE_COLORBOX:false,USE_JAVASCRIPT_MESSAGE:false,PROJECT_STYLESHEET_FILENAME:null,PDF_STYLESHEET_FILENAME:null,ANTIFORGERY_TOKEN:null,CSS_FLIP:false,RESET_HEIGHT:false,DEBUG_ENABLED:false,CONFIRM_CANCEL:true,SEARCH_FILTER_OPTION:null,OPTION_HTML_TEMPLATE:"",TABLE_CLASSNAME:"ew-table",GRID_CLASSNAME:"ew-grid",MULTI_COLUMN_GRID_CLASSNAME:"ew-multi-column-grid",TABLE_ROW_CLASSNAME:"ew-table-row",TABLE_ALT_ROW_CLASSNAME:"ew-table-alt-row",ITEM_TEMPLATE_CLASSNAME:"ew-template",ITEM_TABLE_CLASSNAME:"ew-item-table",TABLE_LAST_COL_CLASSNAME:"ew-table-last-col",TABLE_LAST_ROW_CLASSNAME:"ew-table-last-row",TABLE_PREVIEW_ROW_CLASSNAME:"ew-table-preview-row",TABLE_EDIT_ROW_CLASSNAME:"ew-table-edit-row",TABLE_SELECT_ROW_CLASSNAME:"ew-table-select-row",TABLE_HIGHLIGHT_ROW_CLASSNAME:"ew-table-highlight-row",TABLE_BORDER_BOTTOM_CLASSNAME:"ew-table-border-bottom",REPORT_CONTAINER_ID:"ew-container",ROWTYPE_ADD:2,ROWTYPE_EDIT:3,UNFORMAT_YEAR:50,LAZY_LOAD:false,LAZY_LOAD_DELAY:50,AJAX_DELAY:10,LOOKUP_DELAY:250,MAX_OPTION_COUNT:3,SHOW_EXPORT_DIALOG:true,language:null,vars:null,googleMaps:[],addOptionDialog:null,emailDialog:null,importDialog:null,modalDialog:null,modalLookupDialog:null,lightboxSettings:{transition:"none",photo:true,opacity:.5},importUploadOptions:{maxFileSize:1e7,maxNumberOfFiles:10},IS_SCREEN_SM_MIN:window.matchMedia&&window.matchMedia("(min-width: 768px)").matches||!window.matchMedia&&$(window).width()>=768,MOBILE_DETECT:new MobileDetect(window.navigator.userAgent)};jQuery.extend(ew,function(e,t){var a=e(document);var i=!!t.MOBILE_DETECT.mobile();var n={highlight:true,hint:true,minLength:1,limit:10,trigger:"click",delay:0,templates:{footer:'<div class="tt-footer"><a href="#" class="tt-more"></a></div>'}};var r=function(t){var a=e.isString(t)?t:b(t).id;return arguments.callee[a]};function s(){var e=n;e.limit=t.AUTO_SUGGEST_MAX_ENTRIES;return e}function l(e){n=e}function o(a){var i=a&&a.target?a.target:document;e(i).find(".ew-icon").closest("a, button").add(".ew-tooltip").tooltip({container:"body",trigger:t.IS_MOBILE?"manual":"hover",placement:"bottom"})}function d(a){var i=a&&a.target?a.target:document;var n=function(e){return t.language.phrase("CurrentPassword")+e};if(e.fn.pStrength&&typeof t.MIN_PASSWORD_STRENGTH!="undefined"){e(i).find(".ew-password-strength").each(function(){var a=e(this);if(!a.data("pStrength"))a.pStrength({changeBackground:false,backgrounds:[],passwordValidFrom:t.MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(a,i){var n=e(this),r=e("[id='"+n.attr("data-password-strength")+"']"),s=r.find(".progress-bar");if(n.val()){var l=i+"%";if(i<25){s.addClass("bg-danger").removeClass("bg-warning bg-info bg-success")}else if(i<50){s.addClass("bg-warning").removeClass("bg-danger bg-info bg-success")}else if(i<75){s.addClass("bg-info").removeClass("bg-danger bg-warning bg-success")}else{s.addClass("bg-success").removeClass("bg-danger bg-warning bg-info")}s.css("width",l);if(i>25)l=t.language.phrase("PasswordStrength").replace("%p",l);s.html(l);r.removeClass("d-none").show();n.data("validated",i>=t.MIN_PASSWORD_STRENGTH)}else{r.addClass("d-none").hide();n.data("validated",false)}}}).on("keyup change",function(){var t=e(this),a=e("#"+t.data("password-generated"));if(a.is(":visible")){a.toggle(!!t.val());a.html(n(t.val()))}})})}if(e.fn.pGenerator){e(i).find(".ew-password-generator").each(function(){var a=e(this);if(!a.data("pGenerator"))a.pGenerator({passwordLength:t.GENERATE_PASSWORD_LENGTH,uppercase:t.GENERATE_PASSWORD_UPPERCASE,lowercase:t.GENERATE_PASSWORD_LOWERCASE,numbers:t.GENERATE_PASSWORD_NUMBER,specialChars:t.GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(t){var a=e(this);e("#"+a.attr("data-password-field")).val(t).change().focus().triggerHandler("click");e("#"+a.attr("data-password-confirm")).val(t);e("#"+a.attr("data-password-strength")).addClass("d-none").hide();e("#"+a.attr("data-password-generated")).html(n(t)).removeClass("d-none").show()}})})}}function f(){var a,i,n,r,s,l=e("#ew-timer"),o=t.SESSION_KEEP_ALIVE_INTERVAL>0||t.IS_LOGGEDIN&&t.IS_AUTOLOGIN;var d=function(){var a=t.API_URL+"?"+t.API_ACTION_NAME+"="+t.API_SESSION_ACTION+"&rnd="+_t();a+="&token="+t.ANTIFORGERY_TOKEN;e.get(a,function(a){t.ANTIFORGERY_TOKEN=a;e("input:hidden[name=token]").val(a)})};l.find(".modal-footer .btn-primary").click(function(e){if(n)n.cancel();l.modal("hide");d();if(!o&&t.SESSION_TIMEOUT>0)c()});var f=function(){s=t.SESSION_TIMEOUT_COUNTDOWN;a=t.SESSION_TIMEOUT-t.SESSION_TIMEOUT_COUNTDOWN;if(a<0){a=0;s=t.SESSION_TIMEOUT}if(n)n.cancel();if(i)i.cancel()};var u=function(){if(r)r.cancel();n=e.later(1e3,null,function(){if(s>0){l.find(".modal-body").html('<p class="text-danger">'+t.language.phrase("SessionWillExpire").replace("%s",s)+"</p>");l.modal("show")}else{l.find(".modal-body").html('<p class="text-danger">'+t.language.phrase("SessionExpired")+"</p>");f();e.later(1e3,null,function(){l.modal("hide");window.location=t.TIMEOUT_URL+"?expired=1"})}s--},null,true)};var c=function(){f();i=e.later(a*1e3,null,u)};if(o){var p=t.SESSION_KEEP_ALIVE_INTERVAL>0?t.SESSION_KEEP_ALIVE_INTERVAL:t.SESSION_TIMEOUT-t.SESSION_TIMEOUT_COUNTDOWN;if(p<=0)p=60;r=e.later(p*1e3,null,d,null,true)}else{if(t.SESSION_TIMEOUT>0)c()}}function u(t){var a=t&&t.target?t.target:document;e(a).find(".ew-export-link[href]:not(.ew-email):not(.ew-print):not(.ew-xml)").click(function(t){var a,i=e(this),n=i.attr("href");if(n)p(n);t.preventDefault()})}function c(t){var a=t&&t.target?t.target:document;var i=e(a).find("input[type=checkbox].ew-multi-select");i.click(function(t){var a=this.name.split("_")[0],n=i.filter("[name^='"+a+"_']"),r=n.length,s=n.filter(":checked").length;e(this.form).find("input[type=checkbox]#"+a).prop("checked",s==r).prop("indeterminate",s!=r&&s!=0)})}function p(e,i){var n,r=window.location!=window.parent.location&&window.parent.jQuery?window.parent.jQuery:jQuery;r("body").css("cursor","wait");if(t.SHOW_EXPORT_DIALOG){n=r("#ew-message-box");n.find(".modal-body").html("<p>"+t.language.phrase("Exporting")+"</p>");n.find(".modal-footer button").prop("disabled",true);n.modal("show")}var s=i?"POST":"GET";r.fileDownload(e,{httpMethod:s,data:i||null,successCallback:function(e){if(t.SHOW_EXPORT_DIALOG)n.modal("hide");a.trigger("export",[{type:"done",url:e}])},failCallback:function(e,i){if(t.SHOW_EXPORT_DIALOG)n.find(".modal-body").html("<div class='text-danger'><h4>"+t.language.phrase("FailedToExport")+"</h4>"+e+"</div>");a.trigger("export",[{type:"fail",url:i}])}}).always(function(){if(t.SHOW_EXPORT_DIALOG)n.find(".modal-footer button").prop("disabled",false);r("body").css("cursor","default");a.trigger("export",[{type:"always",url:e}])})}function h(i){if(!t.LAZY_LOAD)return;var n=i&&i.target?i.target:document,r=e(n).find("img.ew-lazy"),s=r.length;r.each(function(i){var n=this;e.later(i*t.LAZY_LOAD_DELAY,null,function(){var t=e(n),r=t.data("src");if(r)t.prop("src",r);if(i==s-1)a.trigger("lazyload")})})}function g(a){var i=a&&a.target?a.target:document;e.extend(t.lightboxSettings,{title:t.language.phrase("LightboxTitle"),current:t.language.phrase("LightboxCurrent"),previous:t.language.phrase("LightboxPrevious"),next:t.language.phrase("LightboxNext"),close:t.language.phrase("LightboxClose"),xhrError:t.language.phrase("LightboxXhrError"),imgError:t.language.phrase("LightboxImgError")});e(i).find(".ew-lightbox").each(function(){var a=e(this);a.colorbox(e.extend({rel:a.data("rel")},t.lightboxSettings))})}function m(t){var a=t&&t.target?t.target:document,i=e(a);i.find("input[data-toggle=tooltip],textarea[data-toggle=tooltip],select[data-toggle=tooltip]").each(function(){var t=e(this);t.tooltip(e.extend({html:true,placement:"bottom"},t.data()))});i.find("a.ew-tooltip-link").each(He);i.find(".ew-tooltip").tooltip({placement:"bottom"});i.find(".ew-popover").popover()}function v(i,n){var l=this,o=false;this.id=i;this.pageId=n;this.$element=null;this._form=null;this.initSearchPanel=false;this.modified=false;this.validateRequired=true;this.validate=null;this.emptyRow=null;this.multiPage=null;this.autoSuggests={};this.searchOperatorChanged=function(t){var a=this.getForm(),i=e(a),n=e.isString(t)?a.elements[t]:t;if(!n)return;var r=n.id.substr(2),s=e(n).val(),l=s=="BETWEEN",o=s=="IS NULL"||s=="IS NOT NULL";if(/^z_/.test(n.id))i.find("[name^=x_"+r+"],[name^=cal_x_"+r+"]").prop("disabled",o);if(/^w_/.test(n.id))i.find("[name^=y_"+r+"],[name^=cal_y_"+r+"]").prop("disabled",o);i.find("span.btw0_"+r).toggleClass("d-none",l).end().find("span.btw1_"+r).toggleClass("d-none",!l).find(":input").prop("disabled",!l).end().find(":button").toggleClass("disabled",!l).prop("disabled",!l)};this.disableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;var a=this.getForm();e(a).find(":submit:not(.dropdown-toggle)").prop("disabled",true).addClass("disabled")};this.enableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;var a=this.getForm();e(a).find(":submit:not(.dropdown-toggle)").prop("disabled",false).removeClass("disabled")};this.appendHidden=function(t){var a=this.getForm(),i=e(a),n=e(t).closest(".ew-form"),r=n.attr("id")+"$"+t.name;if(i.find("input:hidden[name='"+r+"']")[0])return;var s=n.find('[name="'+t.name+'"]').serializeArray();if(s.length){e.each(s,function(t,a){e('<input type="hidden" name="'+r+'">').val(a.value).appendTo(i)})}else{e('<input type="hidden" name="'+r+'">').val("").appendTo(i)}};this.canSubmit=function(){var t=this.getForm(),a=e(t);this.disableForm();this.updateTextArea();this.postAutoSuggest();if(!this.validate||this.validate()&&!a.find(".is-invalid")[0]){a.find("input[name^=sv_], .ew-template input").prop("disabled",true);a.find("[data-readonly=1][disabled]").prop("disabled",false);var i=e(a.find("input[name='detailpage']").map(function(e,t){return a.find("#"+t.value).get()}));if(i.length>1){i.each(function(t,a){e(a).find(":input").each(function(e,t){if(/^(fn_)?(x|o)\d*_/.test(t.name)){var n=i.not(a).find(":input[name='"+t.name+"']");if(n.length){l.appendHidden(t);n.each(function(){l.appendHidden(this)})}}})})}return true}else{this.enableForm()}return false};this.submit=function(e){var t=this.getForm();if(this.canSubmit()){if(e)t.action=e;t.submit()}return false};this.lists=function(e){e=e.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");return this.lists[e]};this.compileTemplates=function(){for(var t in this.lists){var a=this.lists[t];if(a.template&&e.isString(a.template))a.template=e.templates(a.template)}};this.getForm=function(){if(!this._form){this.$element=e("#"+this.id);if(this.$element.is("form")){this._form=this.$element[0]}else if(this.$element.is("div")){this._form=this.$element.closest("form")[0]}}return this._form};this.getElement=function(t){if(!this.$element)this.$element=e("#"+this.id);return t?fe(t,this.$element):this.$element[0]};this.getElements=function(t){if(!this.$element)this.$element=e("#"+this.id);var a="[name='"+t+"']";a="input"+a+",select"+a+",textarea"+a+",button"+a;var i=this.$element.find(a);return i.length==0?null:i.length==1&&i.is(":not([type=checkbox]):not([type=radio])")?i[0]:i.get()};this.postAutoSuggest=function(){for(var e in this.autoSuggests){var t=this.autoSuggests[e].$input;if(t&&t.is(":focus")){t.blur();break}}};this.updateLists=function(a){if(a===$rowindex$)return;var i=[],n=this.getForm();this.compileTemplates();for(var r in this.lists){var s=this.lists[r].parentFields.slice();var l=this.lists[r].ajax;if(e.isValue(a)){r=r.replace(/^x_/,"x"+a+"_");for(var o=0,d=s.length;o<d;o++)s[o]=s[o].replace(/^x_/,"x"+a+"_")}if(e.isBoolean(l)){var f=[];for(var o=0,d=s.length;o<d;o++)f[f.length]=me(s[o],n);i[i.length]=[r,f,l,false]}else{S.call(this,r,s,null,false)}}for(var o=0,u=i.length;o<u;o++)e.later(t.AJAX_DELAY*o,this,S,i[o])};this.createAutoSuggest=function(t){var a=t.id;t.form=this;var i=e.extend({},s(),t);var n=a.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");var r=e.extend(true,{},l.lists[n],{options:null,template:null});if(!(l.autoSuggests[a]instanceof ye))i.data=r;l.autoSuggests[a]=new ye(i)};this.createEditor=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each(function(a,i){var n=e(i).data("editor");if(!n||n.active||n.name.indexOf("$rowindex$")>-1||t&&n.name!=t)return true;n.create();if(t)return false})};this.updateTextArea=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each(function(a,i){var n=e(i).data("editor");if(!n||t&&n.name!=t)return true;n.save();if(t)return false})};this.destroyEditor=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each(function(a,i){var n=e(i).data("editor");if(!n||t&&n.name!=t)return true;n.destroy();if(t)return false})};this.onError=function(e,t){return j(this,e,t)};this.initUpload=function(){var a=this.getForm();e(a.elements).filter("input:file:not([name*='$rowindex$'],[id='importfiles'])").each(function(a){e.later(t.AJAX_DELAY*a,null,Et,this)})};this.setupFilters=function(a,i){var n=this.id,r=this.filterList?this.filterList.data:null,s=e(".ew-save-filter[data-form="+n+"]").toggleClass("disabled",!r),o=e(".ew-delete-filter[data-form="+n+"]").toggleClass("disabled",!i.length),d=o.parent("li").toggleClass("dropdown-submenu",!!i.length).toggleClass("disabled",!i.length),f=s.parent("li").toggleClass("disabled",!r),u=e(a.target);var c=function(a,i){if(t.SEARCH_FILTER_OPTION=="Client"){e.localStorage.set(a+"_filters",i)}else if(t.SEARCH_FILTER_OPTION=="Server"){var n={ajax:"savefilters",filters:JSON.stringify(i),token:t.ANTIFORGERY_TOKEN};e("body").css("cursor","wait");e.ajax(Ye(),{type:"POST",dataType:"json",data:n}).done(function(e){if(e[0]&&e[0].success)l.filterList.filters=i}).always(function(){e("body").css("cursor","default")})}};f.off("click.ew").on("click.ew",function(e){if(f.hasClass("disabled"))return false;E(t.language.phrase("EnterFilterName"),function(e){i[i.length]=[e,r];c(n,i)},true)}).prevAll().remove();o.next("ul.dropdown-menu").remove();if(i.length){var p=o.closest("ul.dropdown-menu");var h=e("<ul class='dropdown-menu'></ul>");for(var g in i){if(!e.isArray(i[g]))continue;e("<li><a class='dropdown-item' data-index='"+g+"' href='#'>"+i[g][0]+"</a></li>").on("click",function(a){var r=e(this).find("a[data-index]").data("index");E(t.language.phrase("DeleteFilterConfirm").replace("%s",i[r][0]),function(e){if(e){i.splice(r,1);c(n,i)}})}).appendTo(h);e("<li><a class='dropdown-item ew-filter-list' data-index='"+g+"' href='#'>"+i[g][0]+"</a></li>").insertBefore(f).on("click",function(a){var n=e(this).find("a[data-index]").data("index");e("<form>").attr({method:"post",action:Ye()}).append(e("<input type='hidden'>").attr({name:"cmd",value:"resetfilter"}),e("<input type='hidden'>").attr({name:"token",value:t.ANTIFORGERY_TOKEN}),e("<input type='hidden'>").attr({name:"filter",value:JSON.stringify(i[n][1])})).appendTo("body").submit()})}e("<li class='dropdown-divider'></li>").insertBefore(f);d.append(h)}};this.init=function(){if(this._initiated)return;if(t.SEARCH_FILTER_OPTION=="Client"&&window.localStorage||t.SEARCH_FILTER_OPTION=="Server"&&t.IS_LOGGEDIN&&!t.IS_SYS_ADMIN&&t.CURRENT_USER_NAME!=""){e(".ew-filter-option."+this.id+" .ew-btn-dropdown").on("show.bs.dropdown",function(a){var i=[];if(t.SEARCH_FILTER_OPTION=="Client")i=e.localStorage.get(l.id+"_filters")||[];else if(t.SEARCH_FILTER_OPTION=="Server")i=l.filterList&&l.filterList.filters?l.filterList.filters:[];var n=e.grep(i,function(t){if(e.isArray(t)&&t.length==2)return t});l.setupFilters(a,n)});e(".ew-filter-option").show()}else{e(".ew-filter-option").hide()}var i=this.getForm(),n=e(i);if(!i)return;this.compileTemplates();var r=/s(ea)?rch$/.test(this.id);if(r&&this.initSearchPanel&&!A(i))e("#"+this.id+"-search-panel").removeClass("show");e(".ew-search-toggle[data-form="+this.id+"]").on("click.bs.button",function(){e("#"+e(this).data("form")+"-search-panel").collapse("toggle")});if(!e(".ew-table .ew-search-operator").text().trim())e(".ew-table .ew-search-operator").parent("td").hide();if(r){e(".ew-highlight[data-form="+this.id+"]").on("click.bs.button",function(){e("span."+e(this).data("name")).toggleClass("ew-highlight-search")})}if(r){n.find("select[id^=z_]").each(function(){var t=e(this).change();if(t.val()!="BETWEEN")n.find("#w_"+this.id.substr(2)).change()})}if(this.multiPage)this.multiPage.render();this.createEditor();this.updateLists();this.initUpload();if(!t.RESET_HEIGHT&&n.is("form")){if(n.width()>e(".content").width())a.trigger("overflow",[n])}if(this.$element.is("form")){n.submit(function(e){return l.submit()});n.find("[data-field], .ew-priv").change(function(){if(t.CONFIRM_CANCEL)l.modified=true});n.find("#btn-cancel[data-href]").click(function(){l.updateTextArea();l.postAutoSuggest();var a=e(this).data("href");if(l.modified&&A(i)){E(t.language.phrase("ConfirmCancel"),function(e){if(e)window.location=a})}else{window.location=a}})}this._initiated=true;this.$element.data("form",this)};r[this.id]=this}function _(t){var a=t&&t.target?t.target:document,i=e(a);for(var n in r){if(i.find("#"+n))r[n].init()}}function E(t,a,i){var n=e("#ew-prompt"),r=n.find(".modal-body").empty();if(i){r.append('<div class="form-group row">'+'<label class="col-form-label">'+t+"</label>"+'<input type="text" class="form-control d-block w-100"></div>');var s=r.find("input").click(function(){s.removeClass("is-invalid")});n.find(".modal-footer .btn-primary").off().click(function(t){var i=s.val().trim();if(i==""){s.addClass("is-invalid");s[0].focus()}else{n.modal("hide");if(e.isFunction(a))a(i)}});n.on("shown.bs.modal",function(e){s[0].focus()})}else{r.append("<div>"+t+"</div>");n.find(".modal-footer .btn-primary").off().click(function(t){n.modal("hide");if(e.isFunction(a))a(true)});if(a){n.find(".modal-footer .btn-default").off().click(function(t){n.modal("hide");if(e.isFunction(a))a(false)}).show()}else{n.find(".modal-footer .btn-default").hide()}}n.modal("show")}function b(t){var a=e(t),i=a.closest(".ew-form");if(!i[0])i=a.closest(".ew-grid, .ew-multi-column-grid").find(".ew-form").not(".ew-pager-form");return i[0]}function A(t){var a="[name^=x_][value!='{value}'],[name^=y_],[name^=z_],[name^=w_],[name=psearch]",i=e(t).find(a).filter(":enabled").get();for(var n=0,r=i.length;n<r;n++){var s=i[n];if(/^(z|w)_/.test(s.name)){if(/^IS/.test(e(s).val()))return true}else if(s.type=="checkbox"||s.type=="radio"){if(s.checked)return true}else if(s.type=="select-one"||s.type=="select-multiple"){if(!!e(s).val())return true}else if(s.type=="text"||s.type=="hidden"||s.type=="textarea"){if(s.value)return true}}return false}function w(a,i){var n=e(a),r=n.closest("form"),s="";r.find("input[name=psearchtype]").val(i||"");if(i=="="){s=t.language.phrase("QuickSearchExactShort")}else if(i=="AND"){s=t.language.phrase("QuickSearchAllShort")}else if(i=="OR"){s=t.language.phrase("QuickSearchAnyShort")}else{s=t.language.phrase("QuickSearchAutoShort")}r.find("#searchtype").html(s+(s?"&nbsp;":""));n.closest("ul").find("li").removeClass("active");n.closest("li").addClass("active");return false}function S(i,n,s,l){var o=this,d=e(this);var f=function(){if(d.queue().length){d.dequeue()}else{a.trigger("updatedone",[{source:o,target:i}])}};var u=this.$element?this.$element[0]:this.form?this.form:null;if(!u)return f();var c=this._form?this:r[u.id];if(!c)return f();var p=e.makeArray(arguments);if(this.form&&e.isUndefined(i))i=r(this).lists[this.name.replace(/^(sv_)?[xy]\d*_/,"x_")].childFields.slice();if(!i||e.isArray(i)&&i.length==0)return f();if(e.isArray(i)&&e.isString(i[0])){for(var h=0,g=i.length;h<g;h++){var m=i[h].split(" ");if(m.length==1&&o.form){var v=Ee(o,false).match(/^([xy]\d*_)/);if(v)i[h]=i[h].replace(/^([xy]\d*_)/,v[1])}var _=de(i[h],u),E=[];if(m.length==2&&e.isArray(_)){var A=e(_);A.each(function(){if(!E.includes(this.name)){E[E.length]=this.name;var t=A.filter("[name='"+this.name+"']"),a=t.attr("type");if(a=="radio"||a=="checkbox")d.queue(e.proxy(S,o,t.get(),n,s,l));else d.queue(e.proxy(S,o,t[0],n,s,l))}})}else{d.queue(e.proxy(S,o,_,n,s,l))}}var w=r(this).lists[this.name.replace(/^[xy]\d*_/,"x_")];if(w&&w.autoFill)d.queue(function(){Be(o)});return f()}if(e.isString(i))i=de(i,u);if(!i||e.isArray(i)&&i.length==0)return f();var m=me(i);var I=Ee(i,false);if(!I)return f();var O="",y="",v=I.match(/^([xy])(\d*)_/);if(v){O=v[1];y=v[2]}var x=I.replace(/^([xy])(\d*)_/,"x_");var L=[];var C=b(i);if(!C||!C.id)return f();var R=r[C.id];if(!R)return f();if(e.isUndefined(n)){n=R.lists[x].parentFields.slice();if(y!=""){for(var h=0,g=n.length;h<g;h++){var N=n[h].split(" ");if(N.length==1)n[h]=n[h].replace(/^x_/,"x"+y+"_")}}else if(O=="y"){}}if(e.isArray(n)&&n.length>0){if(e.isArray(n[0])){L=n}else if(e.isString(n[0])){for(var h=0,g=n.length;h<g;h++)L[L.length]=me(n[h],u)}}if(!F(i))_e(i);var P=function(t){for(var n=0,r=t.length;n<r;n++){var s={data:t[n],parents:L,valid:true,name:Ee(i),form:C};a.trigger("addoption",[s]);if(s.valid)Te(i,t[n],C)}if(!i.options&&i.length){Ie(i);i=de(I,C)}Oe(i,m);if(l!==false){if(!i.options&&i.length)e(i).first().triggerHandler("click");else e(i).first().change()}};if(e.isUndefined(s))s=R.lists[x].ajax;if(!e.isBoolean(s)||e.isArray(R.lists[x].options)&&R.lists[x].options.length>0){var M=R.lists[x].options;P(M);if(/s(ea)?rch$/.test(u.id)&&O=="x"){p[0]=I.replace(/^x_/,"y_");S.apply(this,p)}return f()}else{var D=Ee(i),k=e.extend(true,{},R.lists[x],{options:null,template:null,ajax:"updateoption",name:D,token:t.ANTIFORGERY_TOKEN},T("#p_"+I,u));k[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;if(F(i)&&this._form)k["v0"]=m[0]?m[0]:_t();else if($(i))k["v0"]=m[0]?e(i).data("multiple")?m.join(t.LOOKUP_FILTER_VALUE_SEPARATOR):m[0]:_t();for(var h=0,U=L.length;h<U;h++)k["v"+(h+1)]=L[h].join(t.LOOKUP_FILTER_VALUE_SEPARATOR);e.ajax(t.API_URL,{type:"POST",dataType:"json",data:k,async:s,success:function(e){P(e.records||[])}}).always(function(){f()});if(/s(ea)?rch$/.test(u.id)&&O=="x"){p[0]=I.replace(/^x_/,"y_");S.apply(this,p)}}}function T(t,a){var t=t.replace(/\[\]$/,""),i={};var a=!e.isString(a)?a:/^#/.test(a)?a:"#"+a;var n=a?e(a).find(t):e(t);var r=n.val();if(r){var s=r.split("&");for(var l=0,o=s.length;l<o;l++){var d=s[l].split("=");if(d.length==2)i[d[0]]=d[1]}}return i}function I(e){this.obj=e;this.phrase=function(e){return this.obj[e.toLowerCase()]}}function O(i,n,r,s,l){var o,d={data:l||{},id:i,template:n,filename:r,export:s,enabled:true};if(e.views&&n&&(o=e("#"+n))[0]){if(!o.attr("type"))o.attr("type","text/html");a.trigger("rendertemplate",[d]);if(d.enabled)e("#"+i).html(o.render(d.data))}if(s&&s!="print"){e(function(){var a=e("meta[http-equiv='Content-Type']");var n="<html><head>";var r=e("#"+i);if(a[0])n+="<meta http-equiv='Content-Type' content='"+a.attr("content")+"'>";if(s=="pdf"){n+="<link rel='stylesheet' type='text/css' href='"+t.PDF_STYLESHEET_FILENAME+"'>";if(r.children(0).is("div[id^=ct_]"))r=r.children(0)}else{n+="<style>"+e.ajax({async:false,type:"GET",url:t.PROJECT_STYLESHEET_FILENAME}).responseText+"</style>"}n+="</"+"head><body>"+r.html()+"</body></html>";var l=Ye();var o={customexport:s,data:n,filename:d.filename};if(s=="email"){var f=window.location.search.replace(/^\?/,"")+"&"+e.param(o)+"&token="+t.ANTIFORGERY_TOKEN;e.post(l,f,function(e){vt(e)})}else{p(l,o)}})}}function y(t,i){var n=t&&t.render?t:e(t);if(!n.render)return;var r={$template:n,data:i};a.trigger("rendertemplate",[r]);var s=n.render(r.data),l=r.$template.data("method"),o=r.$template.data("target");if(s&&l&&o)e(s)[l](o);else if(s&&!l&&o)e(o).html(s);else if(s&&!l&&!o)n.parent().append(s);return s}function x(a){var i={},n=a&&a.target?a.target:document;e(n).find(".ew-js-template").sort(function(t,a){t=parseInt(e(t).data("seq"),10)||0;a=parseInt(e(a).data("seq"),10)||0;if(t>a){return 1}else if(t<a){return-1}else{return 0}}).each(function(a){var i=e(this),n=i.data("name"),r=i.data("data");if(r&&e.isString(r)){r=t.vars[r]||window[r];if(!r)return}if(n){if(!e.render[n]){e.templates(n,i.text());y(i,r)}}else{y(i,r)}})}function L(t){e("script"+(t?"."+t:"")+"[type='text/html']").each(function(){var t=e(this);if(/^\s*(<(td|th)[\s\S]*>[\s\S]*<\/\2>)\s*$/i.test(t.html())){t.next().before(RegExp.$1)}else{e(this).after(e("<span></span>").addClass(t.attr("class")).html(t.html()))}t.closest(".ew-table, .ew-view-table, .ew-grid").removeClass("d-none").show()})}function C(e){return e&&["1","y","t","true"].includes(e.toLowerCase())}function R(t,a,i,n){var r=de("x"+a+"_"+i,t);var s=fe("o"+a+"_"+i,t);var l=fe("fn_x"+a+"_"+i,t);if(!s&&(!r||e.isArray(r)&&r.length==0))return false;var o=function(e){return me(e).join(",")};if(s&&r){if(n){if(C(o(s))===C(o(r)))return false}else{var d=o(s);var f=l?o(l):o(r);if(d==f)return false}}return true}function N(e,t){t=t||window.location.search;var a=/(?:\?|&)([^&=]+)=?([^&]*)/g;var i=/\+/g;var n=function(e){return decodeURIComponent(e.replace(i," "))};var r={},s;while((s=a.exec(t))!==null){var l=n(s[1]).replace(/\[\]$/,""),o=n(s[2]);(r[l]||(r[l]=[])).push(o)}return e?r[e]:r}function P(t){var a=e(t),i=a.val()||a.data("language");if(!i)return;var n=window.location.href;if(window.location.search){var r=window.location.search;var s={};r.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,a){if(t)s[t]=a});s["language"]=encodeURIComponent(i);var l="?";for(var o in s)l+=o+"="+s[o]+"&";l=l.substr(0,l.length-1);var d=n.lastIndexOf(window.location.search);n=n.substr(0,d)+l}else{if(window.location.hash)n=n.split("#")[0]+"?language="+encodeURIComponent(i)+"#"+n.split("#")[1];else n+="?language="+encodeURIComponent(i)}window.location=n}function M(a,i){var n=a.target||a.srcElement,r=e(n),s=i.f||r.closest("form")[0]||currentForm,l=e(s),o=i.key,d=i.action,f=i.url||Ye(),u=i.msg,c=i.data,p=i.success,h=!i.method||pe(i.method[0],"p"),g=!i.select&&!i.key||i.select&&pe(i.select[0],"m");if(g&&!l[0])return;if(g&&!V(l[0])){E('<p class="text-danger">'+t.language.phrase("NoRecordSelected")+"</p>");return}var m=function(e){vt(e)};var v=function(){if(h){if(d)e("<input>").attr({type:"hidden",name:"useraction",value:d}).appendTo(l);if(e.isObject(c)){for(var a in c){var i=l.find("input[type=hidden][name='"+a+"']");if(i[0])i.val(c[a]);else e("<input>").attr({type:"hidden",name:a,value:c[a]}).appendTo(l)}}if(!g&&e.isObject(o)){for(var a in o)e("<input>").attr({type:"hidden",name:a,value:o[a]}).appendTo(l)}l.prop("action",f).submit();if(d)l.find("input[type=hidden][name=useraction]").remove()}else{c=e.isObject(c)?e.param(c):e.isString(c)?c:"";c+=(c?"&":"")+"token="+t.ANTIFORGERY_TOKEN;if(d)c+="&useraction="+d+"&ajax="+d;if(g)c+="&"+l.find("input[name='key_m[]']:checked").serialize();else if(o)c+="&"+(e.isObject(o)?e.param(o):o);if(p&&e.isString(p))p=window[p];if(!e.isFunction(p))p=m;e.post(f,c,p)}};if(u){E(u,function(e){if(e)v()})}else{v()}}function D(a,i,n,r,s,l){if(!a)return;var o=e(a),d=o.attr("target"),f=o.attr("action");var u=s&&o.find("input[type=checkbox][name='key_m[]']")[0];if(u&&!V(a)){H(t.language.phrase("NoRecordSelected"));return}if(r){e("iframe.ew-export").remove();if(n=="email")i+=("&"+e(l).serialize()).replace(/&export=email/i,"");if(u){e("<iframe>").attr("name","ew-export-frame").addClass("ew-export d-none").appendTo(e("body"));try{o.append(e("<input type='hidden'>").attr({name:"custom",value:"1"})).attr({action:i,target:"ew-export-frame"}).find("input[name=exporttype]").val(n).end().submit()}finally{o.attr({target:d||"",action:f}).find("input[name=custom]").remove()}}else{e("<iframe>").attr({name:"ew-export-frame",src:i}).addClass("ew-export d-none").appendTo(e("body"))}}else{o.find("input[name=exporttype]").val(n);if(n=="print")o.submit();else p(f,o.serialize())}}function k(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e}function U(t){var a=e(t);return t&&a.is(":hidden")&&a.data("editor")}function $(t){var a=e(t);return t&&a.is(":hidden")&&a.data("lookup")}function F(t){var a=e(t);return a[0]&&a.is(":hidden")&&a.data("autosuggest")}function B(e){return r(e).autoSuggests[e.id]}function H(a,i,n){if(t.IS_MOBILE){alert(a);if(i)e.later(100,null,i)}else{var r=e("#ew-message-box");r.find(".modal-body").html('<p class="text-'+(n||"danger")+'">'+a+"</p>");r.modal("show");if(i)r.off("hidden.bs.modal").on("hidden.bs.modal",i)}}function j(e,t,a){if(t.jquery){var i=t.attr("type");t=i=="checkbox"||i=="radio"?t.get():t[0]}H(a,function(){G(t)});if(e){if(e.multiPage){e.multiPage.gotoPageByElement(t)}else if(e.$element.is("div")){var n=e.$element.closest(".tab-pane");if(n[0]&&!n.hasClass("active"))n.closest(".tabbable, .ew-nav-tabs").find("a[data-toggle=tab][href='#"+n.attr("id")+"']").click()}}return false}function G(t){if(!t)return;var a=e(t);if(U(t)){return a.data("editor").focus()}else if(!t.options&&t.length){t=a.filter("[value!='{value}']")[0]}else if(F(t)){t=B(t).input}var i=a.closest(".form-group, [id^='el_']");if($(t)){i.find(":button").on("click",function(){i.find(".is-invalid").removeClass("is-invalid")})}else{if(t.type=="checkbox"||t.type=="radio"){a.filter("[value!='{value}']").addClass("is-invalid").focus().one("click keypress keyup",function(){i.find(".is-invalid").removeClass("is-invalid")})}else{e(t).addClass("is-invalid").focus().select().parent().one("click keypress keyup",function(){i.find(".is-invalid").removeClass("is-invalid")})}}}function Y(e){return me(e).join("")!=""}function W(e,t,a){if(a==2&&e.ctrlKey)t+="&ctrl=1";location=t;return true}function z(e){ee(e);E(t.language.phrase("DeleteConfirmMsg"),function(t){t&&e.href?window.location=e.href:Z(e)});return false}function V(t){return e(t).find("input[type=checkbox][name='key_m[]']:checked",t).length>0}function K(a){X(a);var i=e(a).closest("."+t.TABLE_CLASSNAME)[0];if(!i)return;e(i.tBodies).each(function(){e(this.rows).each(function(i,n){var r=e(n);if(r.is(":not(."+t.ITEM_TEMPLATE_CLASSNAME+"):not(."+t.TABLE_PREVIEW_ROW_CLASSNAME+")")){r.data({selected:a.checked,checked:a.checked});J(i,n)}})})}function X(t){if(!t||!t.form)return;e(t.form.elements).filter("input[type=checkbox][name^="+t.name+"_], [type=checkbox][name="+t.name+"]").not(t).not(":disabled").prop("checked",t.checked)}function q(t){return e(t).find("input[type=checkbox][name^=u_]:checked,input:hidden[name^=u_][value=1]").length>0}function J(a,i){var n=e(i),r=n.closest("."+t.TABLE_CLASSNAME);if(!r[0])return;if(n.data("selected")){n.removeClass(r.data("rowhighlightclass")||t.TABLE_HIGHLIGHT_ROW_CLASSNAME).removeClass(r.data("roweditclass")||t.TABLE_EDIT_ROW_CLASSNAME).addClass(r.data("rowselectclass")||t.TABLE_SELECT_ROW_CLASSNAME)}else if([t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(n.data("rowtype"))){n.removeClass(r.data("rowselectclass")||t.TABLE_SELECT_ROW_CLASSNAME).removeClass(r.data("rowhighlightclass")||t.TABLE_HIGHLIGHT_ROW_CLASSNAME).addClass(r.data("roweditclass")||t.TABLE_EDIT_ROW_CLASSNAME)}else{n.removeClass(r.data("rowselectclass")||t.TABLE_SELECT_ROW_CLASSNAME).removeClass(r.data("roweditclass")||t.TABLE_EDIT_ROW_CLASSNAME).removeClass(r.data("rowhighlightclass")||t.TABLE_HIGHLIGHT_ROW_CLASSNAME)}}function Q(t){e(t.rows).each(function(t,a){var i=e(a);if(!i.data("checked")&&i.data("selected")){i.data("selected",false);J(t,a)}})}function Z(a){var i=e(a),n=i.closest("."+t.TABLE_CLASSNAME)[0];if(!n)return;var r=i.closest(".ew-table > tbody > tr");r.siblings("[data-rowindex='"+r.data("rowindex")+"']").addBack().each(function(t,a){var i=e(a);i.data("selected",i.data("checked"))})}function ee(a){var i=e(a),n=i.closest("."+t.TABLE_CLASSNAME)[0];if(!n)return;Q(n);var r=i.closest(".ew-table > tbody > tr");r.siblings("[data-rowindex='"+r.data("rowindex")+"']").addBack().each(function(t,a){e(a).data("selected",true);J(t,a)})}function te(a){var i=a.target||a.srcElement,n=e(i),r=n.closest("."+t.TABLE_CLASSNAME)[0];if(!r)return;Q(r);var s=n.closest(".ew-table > tbody > tr");s.siblings("[data-rowindex='"+s.data("rowindex")+"']").addBack().each(function(t,a){e(a).data("checked",i.checked).data("selected",i.checked).find("input[type=checkbox][name='key_m[]']").each(function(){if(this!=i)this.checked=i.checked});J(t,a)});a.stopPropagation()}function ae(a,i,n){var r=e(i),s=e(i.rows);if(!i||!i.rows||!n&&r.data("isset")||i.tBodies.length==0)return;var l=function(a){var i=e(this);if(!i.data("selected")&&![t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(i.data("rowtype"))){var n=i.closest("."+t.TABLE_CLASSNAME);if(!n[0])return;i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each(function(a,i){e(i).addClass(n.data("rowhighlightclass")||t.TABLE_HIGHLIGHT_ROW_CLASSNAME)})}};var o=function(a){var i=e(this);if(!i.data("selected")&&![t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(i.data("rowtype")))i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each(J)};var d=function(a){var i=e(this),n=i.closest("."+t.TABLE_CLASSNAME)[0],r=e(a.target);if(!n||r.hasClass("btn")||r.hasClass("ew-preview-row-btn")||r.is(":input"))return;if(!i.data("checked")){var s=i.data("selected");Q(n);i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each(function(t,a){e(a).data("selected",!s);J(t,a)})}};var f=s.filter("[data-rowindex=1]").length||s.filter("[data-rowindex=0]").length||1;var u=s.filter(":not(."+t.ITEM_TEMPLATE_CLASSNAME+")").each(function(){e(this.cells).removeClass(t.TABLE_LAST_ROW_CLASSNAME).last().addClass(t.TABLE_LAST_COL_CLASSNAME)}).get();var c=r.parentsUntil(".ew-grid",".table-responsive")[0];if(u.length){for(var p=1;p<=f;p++){var h=u[u.length-p];e(h.cells).each(function(){if(this.rowSpan==p)e(this).addClass(t.TABLE_LAST_ROW_CLASSNAME).toggleClass(t.TABLE_BORDER_BOTTOM_CLASSNAME,!!c&&c.clientHeight>i.offsetHeight)})}}var g=r.closest("form")[0];var m=g&&e(g.elements).filter("input#action:not([value^=grid])").length>0;e(i.tBodies[i.tBodies.length-1].rows).filter(":not(."+t.ITEM_TEMPLATE_CLASSNAME+"):not(."+t.TABLE_PREVIEW_ROW_CLASSNAME+")").each(function(a){var i=e(this);if(m&&!i.data("isset")){if([t.ROWTYPE_ADD,t.ROWTYPE_EDIT].includes(i.data("rowtype")))i.on("mouseover",function(){this.edit=true}).addClass(t.TABLE_EDIT_ROW_CLASSNAME);i.on("mouseover",l).on("mouseout",o).on("click",d);i.data("isset",true)}var n=a%(2*f)<f;i.toggleClass(t.TABLE_ROW_CLASSNAME,n).toggleClass(t.TABLE_ALT_ROW_CLASSNAME,!n)});ie(a,r.closest("."+t.GRID_CLASSNAME)[0],n);r.data("isset",true)}function ie(a,i,n){var r=e(i);if(!i||!n&&r.data("isset"))return;var s=r.find("table.ew-multi-column-table").length,l;if(s){l=r.find("td[data-rowindex]").length}else{l=r.find("table."+t.TABLE_CLASSNAME+" > tbody:first > tr:not(."+t.TABLE_PREVIEW_ROW_CLASSNAME+", ."+t.ITEM_TEMPLATE_CLASSNAME+")").length}if(l==0&&!r.find(".ew-grid-upper-panel, .ew-grid-lower-panel")[0])r.hide();r.find(".ew-grid-upper-panel, .ew-grid-lower-panel").each(function(){var t=e(this),a=t.children().map(function(){return e(this).html()}).get().join("");if(a.trim()=="")t.remove()});if(!r.find(".ew-grid-upper-panel:visible")[0])r.css({"border-top-left-radius":0,"border-top-right-radius":0});if(!r.find(".ew-grid-lower-panel:visible")[0])r.css({"border-bottom-left-radius":0,"border-bottom-right-radius":0});r.data("isset",true)}function ne(a){var i=e(a).closest("."+t.GRID_CLASSNAME),n=i.find("table."+t.TABLE_CLASSNAME).last(),r=n.parent("div"),s=n.find("tr."+t.ITEM_TEMPLATE_CLASSNAME);if(!a||!i[0]||!n[0]||!s[0])return;var l=e(n[0].rows).last();n.find("td."+t.TABLE_LAST_ROW_CLASSNAME).removeClass(t.TABLE_LAST_ROW_CLASSNAME);var o=s.clone(true,true).removeClass(t.ITEM_TEMPLATE_CLASSNAME);var d=i.find("div.ew-form[id^=f][id$=grid]");if(!d[0])d=i.find("form.ew-form[id^=f][id$=list]");var f=d.is("div")?"_"+d.attr("id"):"";var u=d.find("#key_count"+f);var c=parseInt(u.val(),10)+1;o.attr({id:"r"+c+o.attr("id").substring(2),"data-rowindex":c});var p=s.find("script:contains('$rowindex$')");o.children("td").each(function(){e(this).find("*").each(function(){e.each(this.attributes,function(e,t){t.value=t.value.replace(/\$rowindex\$/g,c)})})});o.find(".ew-icon").closest("a, button").removeData("bs.tooltip").tooltip({container:"body",placement:"bottom",trigger:"hover"});u.val(c).after(e("<input>").attr({type:"hidden",id:"k"+c+"_action"+f,name:"k"+c+"_action"+f,value:"insert"}));l.after(o);p.each(function(){Ce(this.text.replace(/\$rowindex\$/g,c))});var h=d.data("form");if(h){h.createEditor();h.initUpload()}ae(-1,n[0],true);r.scrollTop(r[0].scrollHeight)}function re(a,i){var n=e(a).tooltip("hide").removeData("bs.tooltip"),r=n.closest("."+t.GRID_CLASSNAME+", ."+t.MULTI_COLUMN_GRID_CLASSNAME),s=n.closest("tr, div[data-rowindex]"),l=s.closest("."+t.TABLE_CLASSNAME);if(!a||!r[0]||!s[0])return;var o=parseInt(s.data("rowindex"),10);var d=r.find("div.ew-form[id^=f][id$=grid]");if(!d[0])d=r.find("form.ew-form[id^=f][id$=list]");var f=d.data("form");if(!d[0]||!f)return;var u=d.is("div")?"_"+d.attr("id"):"";var c="#key_count"+u;var p=d.find(c);var h=function(){s.remove();if(r.is("."+t.GRID_CLASSNAME))ae(-1,l[0],true);if(o>0){var a=d.find("#k"+o+"_action"+u);if(a[0]){a.val(a.val()=="insert"?"insertdelete":"delete")}else{d.find(c).after(e("<input>").attr({type:"hidden",id:"k"+o+"_action"+u,name:"k"+o+"_action"+u,value:"delete"}))}}};if(e.isFunction(f.emptyRow)&&f.emptyRow(i)){h()}else{E(t.language.phrase("DeleteConfirmMsg"),function(e){if(e)h()})}return false}function se(e){var t=String(e);t=t.replace(/&/g,"&amp");t=t.replace(/\"/g,"&quot;");t=t.replace(/</g,"&lt;");t=t.replace(/>/g,"&gt;");return t}function le(t){e(t).find("[id^=x_],[id^=y_],[id^=n_]").each(function(){if(this.type=="checkbox"||this.type=="radio"){this.checked=false}else if(this.type=="select-one"){this.selectedIndex=0}else if(this.type=="select-multiple"){e(this).find("option").prop("selected",false)}else if(this.type=="text"||this.type=="textarea"||this.type=="hidden"&&F(this)){this.value="";if(this.type=="hidden")B(this).input.value=""}})}function oe(a){var i=this;this.$form=null;this.formID=a;this.pageIndex=1;this.maxPageIndex=0;this.minPageIndex=0;this.pageIndexes=[];this.$pages=null;this.$collapses=null;this.isTab=false;this.isCollapse=false;this.lastPageSubmit=false;this.hideDisabledButton=false;this.hideInactivePages=false;this.lockTabs=false;this.hideTabs=false;this.showPagerTop=false;this.showPagerBottom=false;this.pagerTemplate='<nav><ul class="pagination"><li class="page-item previous ew-prev"><a href="#" class="page-link"><span class="icon-prev"></span> {Prev}</a></li><li class="page-item next ew-next"><a href="#" class="page-link">{Next} <span class="icon-next"></span></a></li></ul></nav>';var n=function(e){e.preventDefault()};var r=["lastPageSubmit","hideDisabledButton","hideInactivePages","lockTabs","hideTabs","showPagerTop","showPagerBottom","pagerTemplate"];this.set=function(){if(arguments.length==1&&e.isObject(arguments[0])){var t=arguments[0];for(var a in t){var i=a[0].toLowerCase()+a.substr(1);if(r.includes(i))this[i]=t[a]}}};this.init=function(){var e=this.pagerTemplate.replace(/\{prev\}/i,t.language.phrase("Prev")).replace(/\{next\}/i,t.language.phrase("Next"));if(this.isTab){if(this.showPagerTop)this.$pages.closest(".tabbable, .ew-nav-tabs").before(e);if(this.showPagerBottom)this.$pages.closest(".tabbable, .ew-nav-tabs").after(e);this.$form.find(".ew-prev").click(function(e){i.$pages.off("show.bs.tab",n).filter(".active").parent().prev(":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-toggle=tab]").toggleClass("disabled d-none",false).click();return false});this.$form.find(".ew-next").click(function(e){i.$pages.off("show.bs.tab",n).filter(".active").parent().next(":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-toggle=tab]").toggleClass("disabled d-none",false).click();return false});if(this.hideTabs)this.$form.find(".ew-multi-page > .tabbable > .nav-tabs, .ew-multi-page > .ew-nav-tabs > .nav-tabs").hide()}else if(this.isCollapse){if(this.showPagerTop)this.$collapses.closest(".ew-accordion").before(e);if(this.showPagerBottom)this.$collapses.closest(".ew-accordion").after(e);this.$form.find(".ew-prev").click(function(e){i.$pages.closest(".card").filter(":has(.collapse.show)").prev(":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",false).find("[data-toggle=collapse]").click();return false});this.$form.find(".ew-next").click(function(e){i.$pages.closest(".card").filter(":has(.collapse.show)").next(":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",false).find("[data-toggle=collapse]").click();return false})}this.pageShow()};this.pageShow=function(){if(this.isTab){if(this.lockTabs)this.$pages.on("show.bs.tab",n);this.$pages.each(function(){var t=e(this);if(i.hideInactivePages)t.toggleClass("d-none",!t.hasClass("active"));if(i.lockTabs)t.toggleClass("disabled",!t.hasClass("active"))})}else if(this.isCollapse){this.$pages.closest(".card").each(function(){var t=e(this);if(i.hideInactivePages)t.toggleClass("d-none",!t.find(".collapse.show")[0])})}var t=this.lastPageSubmit&&this.pageIndex!=this.maxPageIndex;var a=this.$form.closest(".content, .modal-content").find("#btn-action, button.ew-submit").prop("disabled",t).toggle(!this.hideDisabledButton||!t);e(".ew-captcha").toggle(a.is(":visible:not(:disabled)"));t=this.pageIndex<=this.minPageIndex;this.$form.find(".ew-prev").toggleClass("disabled",t);t=this.pageIndex>=this.maxPageIndex;this.$form.find(".ew-next").toggleClass("disabled",t)};this.gotoPage=this.gotoPageByIndex=function(e){if(e<=0||e<this.minPageIndex||e>this.maxPageIndex)return;if(this.pageIndex!=e){var t=this.$pages.eq(e-1);if(this.isTab){if(t.is(":not(.d-none):not(.disabled)"))t.click();else t.parent().next(":has([data-toggle=tab]):not(.d-none):not(.disabled)").find("[data-toggle=tab]").toggleClass("disabled",false).click()}else if(this.isCollapse){var a=t.closest(".card");if(a.is(":not(.d-none)"))t.click();else a.next(":has([data-toggle=collapse]):not(.d-none)").find("[data-toggle=collapse]").click()}this.pageIndex=e}};this.gotoPageByElement=function(t){this.gotoPage(parseInt(e(t).data("page"),10)||-1)};this.gotoPageByElementId=function(e){var t=this.$form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.gotoPageByElement(t)};this.togglePage=function(e,t){if(this.isTab){this.$pages.eq(e-1).toggleClass("d-none",!t)}else if(this.isCollapse){this.$pages.eq(e-1).closest(".card").toggle("d-none",!t)}};this.render=function(){this.$form=e("#"+a);this.pageIndexes=this.$form.find("[data-page]").map(function(){var t=parseInt(e(this).data("page"),10);return t>0?t:null}).get();this.pageIndexes.sort(function(e,t){return e-t});this.minPageIndex=this.pageIndexes[0];this.maxPageIndex=this.pageIndexes[this.pageIndexes.length-1];var n=this.$form.find("[data-toggle=tab]");if(n[0]){this.$pages=n;this.isTab=true;n.on("shown.bs.tab",function(a){i.pageIndex=n.index(a.target)+1;i.pageShow();e(e(this).attr("href")).find(".ew-google-map").each(function(){var e=t.googleMaps[this.id];if(e&&e["map"]){google.maps.event.trigger(e["map"],"resize");e["map"].setCenter(e["latlng"])}})});this.pageIndex=n.index(n.parent(".active"))+1}else{this.$collapses=this.$form.find("[data-toggle=collapse]");if(this.$collapses[0]){this.$pages=this.$collapses;this.isCollapse=true;var r=this.$collapses.closest(".card-header").next();r.on("shown.bs.collapse",function(a){i.pageIndex=r.index(a.target)+1;i.pageShow();e(this).find(".ew-google-map").each(function(){var e=t.googleMaps[this.id];if(e&&e["map"]){google.maps.event.trigger(e["map"],"resize");e["map"].setCenter(e["latlng"])}})});this.pageIndex=r.index(r.hasClass("show"))+1}}e(function(){i.init()})}}function de(t,a){var i="[name='"+t+"']";var n=t.split(" ");if(n.length==2)i="[data-table='"+n[0]+"'][data-field='"+Ee(n[1])+"']:not([name^=o]):not([name^='x$'])";var a=!e.isString(a)?a:/^#/.test(a)?a:"#"+a;i="input"+i+",select"+i+",textarea"+i+",button"+i;var r=a?e(a).find(i):e(i);if(r.length==1&&r.is(":not([type=checkbox]):not([type=radio])"))return r[0];return r.get()}function fe(t,a){var a=e.isString(a)?"#"+a:a,i="#"+t.replace(/([\$\[\]])/g,"\\$1")+",[name='"+t+"']";return a?e(a).find(i)[0]:e(i).first()[0]}function ue(e,t){while(e=e.parentNode){if(e&&e.nodeType==1&&(!t||t(e)))return e}return null}function ce(t){return e(t).css("display")=="none"&&!e(t).closest(".dropdown-menu")[0]&&!$(t)&&!F(t)&&!U(t)||ue(t,function(t){var a=e(t);return a.css("display")=="none"&&!a.hasClass("tab-pane")&&!a.hasClass("collapse")})!=null}function pe(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function he(e,t){return String(e)==String(t)}function ge(e,t){return t.indexOf(e)}function me(a,i){var n;if(e.isString(a)){var r=a.split(" ");if(r.length==2){n=de(a)}else{n=de(a,i)}}else{n=a}if(n.options){return e(n).find("option:selected[value!='']").map(function(){return this.value}).get()}else if(e.isNumber(n.length)){return e(n).filter(":checked[value!='{value}']").map(function(){return this.value}).get()}else{var s=e(n).data();if(s.lookup&&s.multiple)return n.value.split(t.LOOKUP_FILTER_VALUE_SEPARATOR);else return[n.value]}}function ve(t,a){var i;if(e.isString(t)){var n=t.split(" ");if(n.length==2){i=de(t)}else{i=de(t,a)}}else{i=t}if(i.options){return e(i).find("option:selected[value!='']").map(function(){return this.text}).get()}else if(e.isNumber(i.length)){return e(i).filter(":checked[value!='{value}']").map(function(){return e(this).parent().text()}).get()}else if(F(i)){return[B(i).input.value]}else if($(i)){var r=e(i);return r.parent().find(".ew-lookup-text .ew-option").map(function(){return e(this).text().trim()}).get()}else{return[i.value]}}function _e(t){if(t.options){var a=t.type=="select-multiple"||e(t).data("pleaseselect")===false||t.length>0&&t.options[0].value!=""?0:1;for(var i=t.length-1;i>=a;i--)t.options[i]=null}else if(t.length){var n=Ee(t),r=e(t).parent().parent().find("#dsl_"+n);r.data("options",[]).find("div").first().empty()}else if(F(t)){var s=B(t);s._options=[];s.input.value="";t.value=""}else if($(t)){e(t).data("options",[])}}function Ee(t,a){var i=e.isString(t)?t:e(t).attr("name")||e(t).attr("id");return a!==false?i.replace(/\[\]$/,""):i}function be(t,a){var i=e(a).data("value-separator");return e.isArray(i)?i[t-1]:i||", "}function Ae(t,a){var i=t.df;for(var n=2;n<=4;n++){if(t["df"+n]&&t["df"+n]!=""){var r=be(n-1,a);if(e.isUndefined(r))break;if(i!="")i+=r;i+=t["df"+n]}}return i}function we(e){return t.OPTION_HTML_TEMPLATE.replace(/\{value\}/g,e)}function Se(e,a){if(e.length>(a||t.MAX_OPTION_COUNT)){return t.language.phrase("CountSelected").replace("%s",e.length)}else if(e.length){var i="";for(var n=0;n<e.length;n++)i+=we(e[n]);return i}else{return t.language.phrase("PleaseSelect")}}function Te(t,i,n){var s=r[n.id],l=Ee(t),o=Ee(t,false),d,f=i.lf,u={lf:i.lf,df1:i.df,df2:i.df2,df3:i.df3,df4:i.df4};if(s.lists(o).template&&!F(t)){d=s.lists(o).template.render(u)}else{d=Ae(i,t)||f}var c={data:u,name:l,form:n.$element,value:f,text:d};if(t.options){e.extend(c,{option:e("<option></option>").val(c.value).html(c.text)});a.trigger("newoption",[c]);e(t).append(c.option)}else if(t.length){var p=e(fe("dsl_"+l,n)),h=p.data("options");if(p[0]&&h)h[h.length]={val:c.value,lbl:c.text}}else if(F(t)){var g=B(t);g._options[g._options.length]={val:c.value,lbl:c.text}}else if($(t)){var m=e(t),h=m.data("options")||[];h[h.length]={val:c.value,lbl:c.text};m.data("options",h)}return c.text}function Ie(i){var n=Ee(i),r=b(i),s=e(i).parent().parent().find("#dsl_"+n);if(!s[0]||!s.data("options"))return;var l=s.parent().find("#tp_"+n);if(!l[0])return;var o=!t.IS_MOBILE?parseInt(s.data("repeatcolumn"),10)||5:1;var d=l.contents(),f=s.data("options"),u=d.attr("type");var c=s.prevAll(".dropdown-toggle"),p=s.closest(".ew-dropdown-list").find(".ew-dropdown-clear");if(f&&f.length){if(o>1||u=="checkbox"||!c[0]){var h=e('<div class="d-table ew-item-table"></div>');if(u=="checkbox")h.click(function(e){e.stopPropagation()});for(var g=0,m=f.length;g<m;g++){var v;if(g%o==0)v=e('<div class="d-table-row"></div>');var _=d.clone(true).val(f[g].val).click(function(t){if(c[0]){var a=h.find("input[name='"+this.name+"']:checked");var i=a.map(function(){return e(this).parent().text()});c.html(Se(i.get(),e(this).data("maxcount")));p.prop("disabled",i.length==0)}});_.attr("id",_.attr("id")+"_"+g);var E=e('<label class="form-check-label"></label>').attr("for",_.attr("id")).append(f[g].lbl);var A={name:n,form:r,value:f[g].val,text:f[g].lbl,option:e('<div class="form-check"></div>').append(_.add(E))};a.trigger("newoption",[A]);e('<div class="d-table-cell"></div>').append(A.option).appendTo(v);if(g%o==o-1){h.append(v)}else if(g==m-1){for(var w=g%o+1;w<o;w++)v.append('<div class="d-table-cell"></div>');h.append(v)}}s.find("div").first().append(h)}else{var S=e('<div class="list-group"></div>');for(var g=0,m=f.length;g<m;g++){var _=d.clone(true).val(f[g].val).click(function(a){var i=e(this).closest(".list-group-item");if(i.hasClass("active"))this.checked=false;i.siblings(".list-group-item").removeClass("active");i.toggleClass("active",this.checked);c.html(this.checked?i.text():t.language.phrase("PleaseSelect"));p.prop("disabled",!this.checked)});_.attr("id",_.attr("id")+"_"+g);var E=e('<label class="form-check-label"></label>').attr("for",_.attr("id")).append(f[g].lbl);var T=e('<a class="list-group-item list-group-item-action" href="#"></a>').append(_,E);var A={name:n,form:r,value:f[g].val,text:f[g].lbl,option:T};a.trigger("newoption",[A]);S.append(A.option)}s.find("div").first().append(S)}p.prop("disabled",c&&(c.html()||"").trim()==t.language.phrase("PleaseSelect")).off().click(function(e){s.find("[data-field][type=radio], [data-field][type=checkbox]").prop("checked",false).first().triggerHandler("click");s.find(".list-group-item.active").removeClass("active");c.html(t.language.phrase("PleaseSelect"))})}if(!s.hasClass("dropdown-menu"))s.removeClass("d-none");s.data("options",[])}function Oe(a,i){if(!a||!i)return;var n=e(a);if(i[0]){if(a.options){e(a).val(i);if(a.type=="select-one"&&a.selectedIndex==-1)a.selectedIndex=0}else if(a.length){if(a.length==1&&a[0].type=="checkbox"&&a[0].value!="{value}"){a[0].checked=C(a[0].value)===C(i[0])}else{n.val(i).closest(".ew-dropdown-list").find(".ew-dropdown-clear").prop("disabled",false)}}else if(F(a)&&i.length==1){var s=B(a),l=s._options||[];for(var o=0,d=l.length;o<d;o++){if(l[o].val==i[0]){a.value=l[o].val;s.input.value=l[o].lbl;break}}}else if($(a)){var n=e(a),f=[],u=[],l=n.data("options")||[];for(var c=0,p=i.length;c<p;c++){for(var o=0,d=l.length;o<d;o++){if(i[c]==l[o].val){f.push(l[o].val);u.push(we(l[o].lbl));break}}}n.val(f.join(t.LOOKUP_FILTER_VALUE_SEPARATOR));n.parent().find(".ew-lookup-text").html(Se(u,n.data("maxcount")))}else if(a.type){a.value=i.join(",")}}function h(t){if(!e(t).data("autoselect"))return false;var a=b(t);if(a){if(/s(ea)?rch$/.test(a.id))return false;var i=r[a.id].lists(t.id);if(i&&i.parentFields.length==0)return false;return true}return false}if(a.options){if(a.type=="select-one"&&a.options.length==2&&!a.options[1].selected&&h(a)){a.options[1].selected=true}else if(a.type=="select-multiple"&&a.options.length==1&&!a.options[0].selected&&h(a)){a.options[0].selected=true}}else if(a.length){if(a.length==2&&h(a[1]))a[1].checked=true;if(a[0].type=="radio")n.filter(":checked").closest(".list-group-item").addClass("active");var g=n.closest(".dropdown-menu");var m=g.closest(".ew-dropdown-list").find(".dropdown-toggle");if(m[0]){var v=g.find("input[name='"+a[0].name+"']:checked");var _=v.map(function(){return e(this).parent().text()});m.html(Se(_.get(),n.data("maxcount")))}}else if(F(a)){var s=B(a),l=s._options||[];if(l.length==1&&h(a)){a.value=l[0].val;s.input.value=l[0].lbl}}}function ye(a){var i,n,r=this,s=a.id,l=a.form,o=a.forceSelect;var d=s.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");var f=RegExp.$1;var u={typeahead:{}};if(f=="$rowindex$")return u;var c=l.getElement();var p=l.getElement("sv_"+s);if(!p)return u;var h=l.getElement("sc_"+s);var g=l.lists[d].parentFields.slice();for(var m=0,v=g.length;m<v;m++){var _=g[m].split(" ");if(_.length==1)g[m]=g[m].replace(/^x_/,"x"+f+"_")}this.data=a.data;this.minWidth=a.minWidth;this.maxHeight=a.maxHeight;this.highlight=a.highlight;this.hint=a.hint;this.minLength=a.minLength;this.limit=a.limit;this.templates=e.extend({},a.templates);this.trigger=a.trigger;this.delay=a.delay;this.display=a.display||"value";this.input=p;this.element=l.getElement(s);this.$input=i=e(this.input);this.$element=n=e(this.element);this._options=[];this._recordCount=0;if(i.val()&&n.val())this._options.push({val:n.val(),lbl:i.val()});this.formatResult=function(e){return Ae(e,this.element)||e[0]};this.setValue=function(a){a=a||i.val();var r=i.data("results")?e.map(i.data("results"),function(e,t){if(e["value"]==a)return t}):[];if(r.length==0){if(this._options&&this._options.length&&this._options[this._options.length-1].lbl==a)return;if(o&&a){i.typeahead("val","").attr("placeholder",t.language.phrase("ValueNotExist")).addClass("is-invalid");n.val("").change();return}}else{if(!/s(ea)?rch$/.test(c.id)||o){var s=r[0];if(s>-1)a=i.data("results")[s]["lf"]}}if(a!==n.val())n.val(a).change()};this.generateRequest=function(){var a=e.extend(true,{},this.data,{name:this.element.name,ajax:"autosuggest",token:t.ANTIFORGERY_TOKEN},T("#p_"+s,c));if(g.length>0){for(var i=0,n=g.length;i<n;i++){var r=me(g[i],c);a["v"+(i+1)]=encodeURIComponent(r.join(","))}}a[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;return a};this.prepare=function(a,i){var n={};n.data=this.generateRequest();n.type="POST";n.dataType="json";n.url=t.API_URL+"?q="+encodeURIComponent(a);n.url+="&n="+this.limit;if(e.isNumber(i))n.url+="&start="+i;n.url+="&rnd="+_t();return n};this.transform=function(t){var a;if(t&&t.result=="OK"){r._recordCount=t.totalRecordCount;a=t.records}i.data("results",a||[]);var n=e.map(i.data("results"),function(e){var t=e["value"]=r.formatResult(e);return{lf:e[0],df1:e[1],df2:e[2],df3:e[3],df4:e[4],value:t}});return n};this.source=function(t,a,i){r._recordCount=0;var n=r.prepare(t);e.ajax(n).done(function(e){i(r.transform(e))})};this.count=function(){return r.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length};this.more=function(){e("body").css("cursor","wait");var t=r.typeahead,a=t.menu.query,i=t.menu.datasets[0];var n=r.count();var s=r.prepare(a,n);e.ajax(s).done(function(e){e=r.transform(e);i._append(a,e);t.menu.$node.find(".tt-dataset").scrollTop(i.$lastSuggestion.outerHeight()*n)}).always(function(){e("body").css("cursor","default")})};i.on("typeahead:select",function(e,t){r.setValue(t.value)}).blur(function(e){var t=i.data("tt-typeahead");if(t&&t.isOpen()&&!t.menu.empty()){var a=t.menu.getActiveSelectable();if(a){var n=a.index();var s=i.data("results")[n][1];i.typeahead("val",s)}}r.setValue()}).focus(function(e){i.attr("placeholder",i.data("placeholder")).removeClass("is-invalid")});var E;if(l.lists[d].template){E=l.lists[d].template}else{E=r.templates["suggestion"]}if(E&&e.isString(E))E=e.templates(E);if(E)r.templates["suggestion"]=e.proxy(E.render,E);n.data("autosuggest",this);e(function(){var a={highlight:r.highlight,minLength:r.minLength,hint:r.hint,trigger:r.trigger,delay:r.delay};var o={name:l.id+"-"+s,source:r.source,templates:r.templates,display:r.display,limit:r.limit,async:true};var d=[a,o];n.trigger("typeahead",[d]);r.limit=o.limit;i.typeahead.apply(i,d);i.on("typeahead:rendered",function(){var i=r.typeahead.menu.$node;var n=i.find(".tt-more").html(t.language.phrase("More"));if(arguments.length>1&&r._recordCount>r.count()){var s;n.one(a.trigger,function(t){if(s)s.cancel();e.later(a.delay,null,function(){r.more()});t.preventDefault();t.stopPropagation()})}else{n.hide()}});i.off("blur.tt");r.typeahead=i.data("tt-typeahead");var f=r.typeahead.menu.$node.css("z-index",9001);if(r.minWidth)f.css("min-width",r.minWidth);var u=f.find(".tt-dataset");var c=r.maxHeight||(parseInt(u.css("line-height"),10)+6)*(o.limit+1);u.css({"max-height":c,"overflow-y":"auto"})})}function xe(e,t){var a,i=0,n=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi;e=e.replace(/<head>[\s\S]*<\/head>/,"");while((a=n.exec(e))!=null){var r=RegExp.$2;if(/(\s+type\s*=\s*['"]*text\/javascript['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1)&&r)Ce(r,"scr_"+t+"_"+i++)}}function Le(e){var t,a=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi;var i=e;while((t=a.exec(e))!=null){var n=RegExp.lastMatch;if(/(\s+type\s*=\s*['"]*text\/javascript['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1))i=i.replace(n,"")}return i}function Ce(e,t){var a=document.createElement("SCRIPT");if(t)a.id=t;a.text=e;return document.body.appendChild(a)}function Re(t){if(t)e("script[id^='scr_"+t+"_']").remove()}function Ne(t){var a=Le(t).match(/<body[\s\S]*>[\s\S]*<\/body>/i);return e(a[0]).not("div[id^=ew].modal, #ew-tooltip, #cookie-consent")}function Pe(t){var a=e(t),i=a.closest("[id^=el]").find("#dsl_"+Ee(t));if(!i[0])return[];var n=a.filter(":checked").map(function(){return this.value}).get();_e(t);i.data("options",a.filter("[value!='{value}']").map(function(){var t=e(this).parent().contents().not(this);return{val:this.value,lbl:t}}).get());return n}function Me(t){if(t.options){return e(t.options).map(function(){return{value:this.value,name:this.text}}).get()}else if(t.length){return e(t).filter("[value!='{value}']").map(function(){var t=e(this).parent().contents().not(this);return{value:this.value,name:t.text()}}).get()}return[]}function De(i){var n=function(){Re(s.data("args").el);var e=s.removeData("args").find(".modal-body form").data("form");if(e)e.destroyEditor();s.find(".modal-body").html("");s.find(".modal-footer .btn-primary").unbind();s.data("showing",false)};var s=t.addOptionDialog||e("#ew-add-opt-dialog").on("hidden.bs.modal",n);if(s.data("showing"))return;s.data("showing",true);if(!s[0]){H("DIV #ew-add-opt-dialog not found.");return}var l=function(i){var n=i;var l=s.data("args");var o=r(l.lnk);var d=l.el;var f="x_",u=-1;if(d.match(/^(x(\d+)_)/)){f=RegExp.$1;u=parseInt(RegExp.$2,10)}var c=d.replace(new RegExp("^"+f),"x_");var p=o.lists[c];var h=p[t.API_LOOKUP_TABLE];if(e.isString(i)){try{n=e.parseJSON(i)}catch(e){}}if(n&&n.success&&n[h]){var g=n[h];s.modal("hide");var m=o.$element[0];var v=de(d,m);if(v){var c=d.replace(new RegExp("^"+f),"x_");var _=o.lists[c].linkField.slice();var E=o.lists[c].displayFields.slice();var b=o.lists[c].filterFields.slice();var A=o.lists[c].parentFields.slice();for(var w=0,S=A.length;w<S;w++){var T=A[w].split(" ");if(T.length==1)A[w]=A[w].replace(/^x_/,f)}var I=_!=""?g[_]:"";var O={lf:I};for(var w=0,S=E.length;w<S;w++){if(E[w]in g)O["df"+(w||"")]=g[E[w]]}for(var w=0,S=b.length;w<S;w++){if(b[w]in g)O["ff"+(w||"")]=g[b[w]]}if(I&&E.length>0&&O["df"]){var y=Ee(d,false),x=y.replace(new RegExp("^"+f),"x_");if(o.lists[x].ajax===null){var T=o.lists[x].options;T[T.length]=O}var L=[];for(var w=0,S=A.length;w<S;w++)L[L.length]=me(A[w],m);var l={data:O,parents:L,valid:true,name:Ee(v),form:m};a.trigger("addoption",[l]);if(l.valid){var T=Me(v),C=[];if(!v.options&&v.length)C=Pe(v);var R=Te(v,O,m);if(v.options){v.options[v.options.length-1].selected=true;e(v).change().focus()}else if(v.length){Ie(v);v=de(y,m);if(C.length>0)Oe(v,C);if(v.length>0){var d=e(v).filter("[value!='{value}']").last()[0];if(d.type=="checkbox"||d.type=="radio")d.click();d.focus()}}else if(F(v)){var N=B(v);e(v).val(I).change();e(N.input).val(R).focus()}else if($(v)){var P=e(v),M=e(fe("lu_"+l.name,m));if(P.data("multiple")){var D=e(v).val(),C=[];if(D!=="")C=D.split(t.LOOKUP_FILTER_VALUE_SEPARATOR);if(!C.includes(I)){C.push(I);P.val(C.join()).change();var k=M.html(),U=M.find(".ew-option");if(U[0]){U.push(we(R));var H=U.map(function(){return e(this).html()}).get();M.html(Se(H,P.data("maxcount")))}else if(k==t.language.phrase("PleaseSelect")){M.html(we(R))}else if(k){M.html(t.language.phrase("CountSelected").replace("%s",C.length))}}}else{P.val(I).change();M.html(R)}}var j=e(m),G=j.is("div")?"_"+j.attr("id"):"";var Y=j.find("#key_count"+G).val();if(Y>0){for(var w=1;w<=Y;w++){if(w==u)continue;var W=de(c.replace(/^x/,"x"+w),m);var z=Me(W),C=[];if(e.param(T)!=e.param(z))continue;if(!W.options&&W.length)C=Pe(W);Te(W,O,m);if(!W.options&&W.length){Ie(W);if(C.length>0)Oe(W,C)}}}}}}}else{var V,K=s.find("div.ew-message-dialog").html(""),X=e("<div></div>").html(i).find("div.ew-message-dialog");if(X[0]){V=X.html()}else{V=n&&n.failureMessage?n.failureMessage:i;if(!V||String(V).trim()=="")V=t.language.phrase("InsertFailed");V='<p class="text-danger">'+V+"</p>"}K.html(V).show()}};var o=function(e){s.modal("hide");H("Server Error "+e.status+": "+e.statusText)};var d=function(a){var i=t.addOptionDialog;var n=i.find(".modal-body form")[0];var s=r[n.id];var d=a?a.target:null;if(d){s.enableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;e(d).prop("disabled",false).removeClass("disabled")};s.disableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;e(d).prop("disabled",true).addClass("disabled")}}if(s.canSubmit())e.post(t.API_URL,e(n).serialize(),l).fail(o).always(function(){s.enableForm()});return false};s.modal("hide");s.data("args",i);var f=function(n){var l=r(i.lnk);var o="x_";if(i.el.match(/^(x\d+_)/))o=RegExp.$1;var f=i.el.replace(o,"x_");var u=l.lists[f].parentFields.slice();var c=l.lists[f].filterFieldVars.slice();var p=l._form;var h=[],g=[];for(var m=0,v=u.length;m<v;m++){var _=u[m].split(" ");if(_.length==1)u[m]=u[m].replace(/^x_/,o)}for(var m=0,v=u.length;m<v;m++){h.push(me(u[m],p));g.push(ve(u[m],p))}s.find(".modal-title").html(e(i.lnk).closest(".ew-add-opt-btn").data("title"));s.find(".modal-body").html(Le(n));var p=s.find(".modal-body form")[0];if(p){e(p).keypress(function(e){if(e.which==13)return d()});var E=function(t,a){return e.isArray(t)&&e.isArray(a)&&t[0]&&a[0]&&t.name==a.name&&t.form==a.form};for(var m=0,v=h.length;m<v;m++){var b=de(c[m],p);if(b&&(b.options||b.length)){var A=h[m];a.one("updatedone",function(e,t){var a=t.target;if(b==a||E(b,a))Oe(a,A)})}}}t.addOptionDialog=s.modal("show");s.find(".modal-footer .btn-primary").click(d).focus();xe(n,i.el);if(p){for(var m=0,v=h.length;m<v;m++){var b=de(c[m],p);if(b){if(F(b)){b.value=h[m][0];var w=B(b);w.input.value=g[m][0];w._options[w._options.length]={val:h[m][0],lbl:g[m][0]}}else if($(b)){b.value=h[m][0];S.call(r[p.id],b)}else if(b.options||b.length){}else{b.value=h[m][0]}}}}s.trigger("load.ew")};e.get(i.url,f).fail(o)}function ke(t){var a=e(this),i=a.data("args");Re("ModalDialog");var n=a.removeData("args").find(".modal-body form").data("form");if(n)n.destroyEditor();var r=a.find(".modal-body").html("");if(r.ewjtable&&r.ewjtable("instance"))r.ewjtable("destroy");a.find(".modal-footer .btn-primary").unbind();a.find(".modal-dialog").removeClass(function(e,t){var a=t.match(/table\-\w+/);return a?a[0]:""});a.data("showing",false);a.data("url",null);if(i&&i.reload)window.location.reload(true)}function Ue(a){var i=a.f,n=e(i);e(a.lnk).tooltip("hide");if(i&&n){if(!n[0])return;if(!V(n[0])){E('<p class="text-danger">'+t.language.phrase("NoRecordSelected")+"</p>");return}}var s=t.modalDialog||e("#ew-modal-dialog").on("hidden.bs.modal",ke);if(s.data("showing")&&s.data("url")==a.url)return;s.data("showing",true);s.data("url",a.url);a.reload=false;var l=function(){var t=s.data("args");var a=e(t.lnk);return t.caption||a.data("caption")||a.data("original-title")||""};var o=function(){var a=s.data("args");if(e.isNull(a.btn))return"";else if(a.btn&&a.btn!="")return t.language.phrase(a.btn);else return l()};var d=function(e){s.modal("hide");if(e.status)H("Server Error "+e.status+": "+e.statusText)};var f=function(t){e("body").css("cursor","default")};var u=function(t){if(e.isString(t)){try{t=e.parseJSON(t)}catch(e){}}return t};var c=function(t){var a=e("<a>",{href:t})[0];return window.location.pathname.endsWith(a.pathname)};var p=function(a){var i=u(a);if(e.isObject(i)){var n=i.url;if(i.modal&&!c(n)){var r=s.data("args");r.reload=true;if(i.caption)r.caption=i.caption;r.btn=i.view?null:"";s.data("args",r);n+=(n.split("?").length>1?"&":"?")+"modal=1&rnd="+_t();e("body").css("cursor","wait");e.ajax(n).done(g).fail(d).always(f)}else{s.modal("hide");window.location=n}}else{var l=Ne(a);var p=s.find(".modal-body").html(l);var m="";var v=p.find("#confirm");var _=p.find("#conflict");if(_&&_.val()=="1"){m+='<button type="button" id="btn-overwrite" class="btn btn-primary ew-btn">'+t.language.phrase("OverwriteBtn")+"</button>";m+='<button type="button" id="btn-reload" class="btn btn-default ew-btn">'+t.language.phrase("ReloadBtn")+"</button>";m+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>";s.find(".modal-footer").html(m);s.find(".modal-footer #btn-overwrite").on("click",{action:"overwrite"},h);s.find(".modal-footer #btn-reload").on("click",{action:"show"},h)}else if(v&&v.val()=="confirm"){m+='<button type="button" class="btn btn-primary ew-btn">'+t.language.phrase("ConfirmBtn")+"</button>";m+='<button type="button" class="btn btn-default ew-btn">'+t.language.phrase("CancelBtn")+"</button>";s.find(".modal-footer").html(m);s.find(".modal-footer .btn-primary").click(h).focus();s.find(".modal-footer .btn-default").on("click",{action:"cancel"},h)}else{var E=o();if(E)m+='<button type="button" class="btn btn-primary ew-btn">'+E+"</button>";m+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>";s.find(".modal-footer").html(m);s.find(".modal-footer .btn-primary").addClass("ew-submit").click(h).focus()}xe(a,"ModalDialog");s.trigger("load.ew")}};var h=function(a){var i=s.find(".modal-body form")[0],n=e(i);var l=r[i.id];var o=a&&a.data?a.data.action:null;var u=a?a.target:null;if(u){l.enableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;e(u).prop("disabled",false).removeClass("disabled")};l.disableForm=function(){if(!t.DISABLE_BUTTON_ON_SUBMIT)return;e(u).prop("disabled",true).addClass("disabled")}}var c=i.elements["action"];if(o&&c)c.value=o;if(o=="cancel"){e.post(n.attr("action"),n.serialize(),g).fail(d).always(f)}else if(l.canSubmit()){e.post(n.attr("action"),n.serialize(),p).fail(d)}return false};s.modal("hide");s.data("args",a);var g=function(a){var i=u(a);if(e.isObject(i)){if(i.error)H(i.error)}else{var n=s.data("args");var r=e(a),d=e(n.lnk);s.find(".modal-title").html(l());var f="";var c=o();if(c)f+='<button type="button" class="btn btn-primary ew-btn">'+c+"</button>";if(f!="")f+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>";else f='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CloseBtn")+"</button>";s.find(".modal-footer").html(f);var p=Ne(a);s.find(".modal-body").html(p);s.find(".modal-body form").keypress(function(e){if(e.which==13&&e.target.nodeName!="TEXTAREA")return h()});t.modalDialog=s.modal("show");s.find(".modal-dialog").addClass("table-"+d.data("table"));s.find(".modal-footer .btn-primary").addClass("ew-submit").click(h).focus();xe(a,"ModalDialog");s.trigger("load.ew")}};e("body").css("cursor","wait");var m=a.url;if(i&&n){e("<input>").attr({type:"hidden",name:"modal",value:"1"}).appendTo(n);e.post(m,n.serialize(),g).fail(d).always(f)}else{m+=(m.split("?").length>1?"&":"?")+"modal=1&rnd="+_t();e.get(m,g).fail(d).always(f)}}function $e(a){var i=a.el,n=b(a.lnk);if(!n||!i)return;var s=t.modalLookupDialog||e("#ew-modal-lookup-dialog").on("hidden.bs.modal",ke);if(s.data("showing"))return;s.data("showing",true);if(!s[0]){H("DIV #ew-modal-lookup-dialog not found.");return}var l=Ee(i,true),o=e(n),d=o.find("[id='"+i+"']"),f=s.find(".modal-body"),u=e(a.lnk),c=u.closest(".ew-lookup-list").find(".ew-lookup-text").focus();var p=Ee(i,false);var h="",g="",m=p.match(/^([xy])(\d*)_/);if(m){h=m[1];g=m[2]}var v=p.replace(/^([xy])(\d*)_/,"x_");var _=r[n.id].lists(v);var E=function(t){if(t.result=="OK"&&e.isArray(t.records)){e.each(t.records,function(a,i){var n;if(e.isArray(i))n={lf:i[0],df1:i[1],df2:i[2],df3:i[3],df4:i[4]};else if(e.isObject(i))n={lf:i.lf,df1:i.df,df2:i.df2,df3:i.df3,df4:i.df4};if(_.template){n["df"]=_.template.render(n)}else{n["df"]=Ae(i,d)}t.records[a]=n})}};var A=function(e,t){if(!F(d))return;var a=B(d[0]);a._options[a._options.length]={val:e,lbl:t};a.input.value=t};var w=function(i){var r=[],s=[],l=[],o=[],u=!a.m&&a.srch;f.ewjtable("selectedRows").each(function(){var t=e(this).data("record");r.push(t.lf);s.push(t.df);l.push(t.df);o.push(t.df)});if(i.sort().join()===r.sort().join()){c.html(Se(l,d.data("maxcount")));A(r.join(),o.join(", "));d.val(u?s.join(", "):r.join()).change()}else{var h=e.extend(true,{},_,{options:null,template:null,ajax:"modal",token:t.ANTIFORGERY_TOKEN,keys:i},T("#p_"+p,n));h[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;e.ajax(t.API_URL,{type:"POST",dataType:"json",data:h}).done(E).then(function(t){if(t.result=="OK"&&e.isArray(t.records)){var a=[],i=[],n=[],r=[],s=t.records;for(var l=0,o=s.length;l<o;l++){var f=s[l];a.push(f.lf);i.push(f.df);n.push(f.df);r.push(f.df)}c.html(Se(n,d.data("maxcount")));A(a.join(),r.join(", "));d.val(u?i.join(", "):a.join()).change()}})}};var S=function(){w(C);s.modal("hide");return false};s.modal("hide");s.data("args",a);var I,O;var y=function(a){if(a.result=="OK"){s.find(".modal-title").html(u.attr("title")||u.data("original-title"));s.find(".modal-footer").html('<button type="button" id="btn-select" class="btn btn-primary ew-btn">'+t.language.phrase("SelectBtn")+"</button>"+'<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+t.language.phrase("CancelBtn")+"</button>");O=e('<input type="search" name="sv" class="form-control mb-2" placeholder="'+t.language.phrase("Search")+'">').prependTo(f).on("keyup",function(a){if(I)I.cancel();I=e.later(t.LOOKUP_DELAY,null,function(){f.ewjtable("load",{sv:O.val()})})});s.find(".modal-footer #btn-select").click(S);t.modalLookupDialog=s.modal("show");s.find("[name=sv]").focus()}else{H(a.message)}};var x=[];var L=d.val();var C=L!==""?L.split(t.LOOKUP_FILTER_VALUE_SEPARATOR):[];var R=e.extend(true,{},_,{options:null,template:null},T("#p_"+p,n));var N=_.parentFields.slice();if(g!=""){for(var P=0,M=N.length;P<M;P++){var D=N[P].split(" ");if(D.length==1)N[P]=N[P].replace(/^x_/,"x"+g+"_")}}if(N.length>0){for(var P=0,M=N.length;P<M;P++)x.push(me(N[P],n))}for(var P=0,k=x.length;P<k;P++)R["v"+(P+1)]=x[P].join(t.LOOKUP_FILTER_VALUE_SEPARATOR);e("body").css("cursor","wait");f.ewjtable({paging:true,pageSize:a.n,pageSizes:[],pageSizeChangeArea:false,pageList:"minimal",selecting:true,selectingCheckboxes:true,multiselect:!!a.m,actions:{listAction:function(a,i){var n=e.extend({},R,{ajax:"modal",start:i.start,recperpage:i.recperpage,token:t.ANTIFORGERY_TOKEN});n[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;if(e.isObject(a))e.extend(n,a);return e.Deferred(function(a){e.ajax(t.API_URL,{type:"POST",dataType:"json",data:n,success:function(e){a.resolve(e)},error:function(){a.reject()}})}).done(E).always(function(){e("body").css("cursor","default")})}},messages:{serverCommunicationError:t.language.phrase("ServerCommunicationError"),loadingMessage:t.language.phrase("Loading"),noDataAvailable:t.language.phrase("NoRecord"),close:t.language.phrase("CloseBtn"),pagingInfo:t.language.phrase("Record")+" {0}-{1} "+t.language.phrase("Of")+" {2}",pageSizeChangeLabel:t.language.phrase("RecordsPerPage"),gotoPageLabel:t.language.phrase("Page")},fields:{lf:{key:true,list:false},df:{}},recordsLoaded:function(t,a){var i=e(t.target).find(".ewjtable-data-row").filter(function(){return C.includes(String(e(this).data("record-key")))});e(t.target).ewjtable("selectRows",i)},selectionChanged:function(t,i){var n=i.rows;if(n){if(!a.m)C=[];n.each(function(){var t=e(this);var a=String(t.data("record-key"));var i=C.indexOf(a);var n=t.hasClass("ewjtable-row-selected");if(n&&i==-1)C.push(a);else if(!n&&i>-1)C.splice(i,1)})}}}).ewjtable("load",null,y)}function Fe(a){var i=t.importDialog||e("#ew-import-dialog");if(!i[0]){H("DIV #ew-import-dialog not found.");return}var n=i.find("#importfiles"),r=i.find(".modal-body"),s=r.find(":input[id!=importfiles]"),l=r.find(".message"),o=r.find(".progress"),d;var f=function(){i.find(".modal-footer .btn").prop("disabled",true)};var u=function(){i.find(".modal-footer .btn").prop("disabled",false)};var c=function(t,a){$msg=e("<div>"+t+"</div>");if(a)$msg.addClass(a);l.removeClass("d-none").html($msg);if(a=="text-danger")u()};var p=function(){l.addClass("d-none").html("")};var h=function(e,t){o.removeClass("d-none").find(".progress-bar").removeClass("bg-success bg-info").addClass(t||"bg-success").attr("aria-valuenow",e).css("width",e+"%").html(e+"%")};var g=function(){o.addClass("d-none").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").html("0%")};var m=function(e){var a=parseInt(100*e.loaded/e.total);h(a,"bg-info");if(a===100){c(t.language.phrase("ImportMessageUploadComplete"),"text-info")}else{c(t.language.phrase("ImportMessageUploadProgress").replace("%p",a),"text-info")}};var v=function(e){try{var a=parseInt(e.count),n=parseInt(e.totalCount),r=e.file;if(n>0&&i.find(".modal-footer .ew-close-btn").data("import-progress")){var s=parseInt(100*a/n);h(s);c(t.language.phrase("ImportMessageProgress").replace("%t",n).replace("%c",a).replace("%f",r),"text-info")}}catch(e){}};var _=function(t){if(e.isString(t)){try{t=e.parseJSON(t.trim())}catch(e){}}return t};var E=function(){var a=t.API_URL+"?"+t.API_ACTION_NAME+"="+t.API_PROGRESS_ACTION+"&rnd="+_t()+"&token="+n.data("token");e.get(a,v,"json")};var b=function(e){var a=5;var n="";h(100);var r=e.files;i.find(".modal-footer .ew-close-btn").data("import-progress",false);for(var s=0,l=r.length;s<l;s++){var o=r[s],d=o.totalCount||0,f=o.count||0,u=o.successCount||0,p=o.failCount||0;if(n!="")n+="<br>";if(o.success){n+=t.language.phrase("ImportMessageSuccess").replace("%t",d).replace("%c",f).replace("%f",o.file)}else{n+=t.language.phrase("ImportMessageError1").replace("%t",d).replace("%c",f).replace("%f",o.file).replace("%s",u).replace("%e",p);if(o.error)n+=t.language.phrase("ImportMessageError2").replace("%e",o.error);var m=true;if(o.failList){var v=0;for(var s=1;s<=f;s++){if(o.failList["row"+s]){v+=1;n+="<br>"+t.language.phrase("ImportMessageError3").replace("%i",s).replace("%d",o.failList["row"+s])}if(v>=a)break}if(p>a)n+="<br>"+t.language.phrase("ImportMessageMore").replace("%s",p-a);else m=false}if(o.log&&m)n+="<br>"+t.language.phrase("ImportMessageError4").replace("%l",o.log);c(n,"text-danger")}}if(e.success){c(n,"text-success");i.find(".modal-footer .ew-close-btn").data("imported",true)}else{c(n,"text-danger")}g()};var A=function(e){i.find(".modal-footer .ew-close-btn").data("import-progress",false);c(t.language.phrase("ImportMessageServerError").replace("%s",e.status).replace("%t",e.statusText),"text-danger")};var w=function(a){e("body").css("cursor","wait");n.data("token",a);i.find(".modal-footer .ew-close-btn").data("import-progress",true);var r=t.API_ACTION_NAME+"=import&token="+encodeURIComponent(t.ANTIFORGERY_TOKEN)+"&filetoken="+encodeURIComponent(a);if(s.length)r+="&"+s.serialize();e.ajax(Ye(),{data:r,method:"POST",dataType:"json",beforeSend:function(t,a){d=e.later(100,null,E,null,true)}}).done(b).fail(A).always(function(){e("body").css("cursor","default");if(d)d.cancel()})};var S={token:t.ANTIFORGERY_TOKEN,session:t.SESSION_ID};S[t.API_ACTION_NAME]=t.API_UPLOAD_ACTION;var T=t.importUploadOptions;if(!T.acceptFileTypes)T.acceptFileTypes=new RegExp("\\.("+t.IMPORT_FILE_ALLOWED_EXT.replace(/,/g,"|")+")$","i");if(!n.data("blueimpFileupload")){n.fileupload(e.extend({url:t.API_URL,dataType:"json",autoUpload:true,formData:S,singleFileUploads:false,messages:{acceptFileTypes:t.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:t.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:t.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:t.language.phrase("UploadErrMsgMinFileSize")},done:function(a,i){if(i.result&&i.result.files&&e.isArray(i.result.files.importfiles)){var n=true;e.each(i.result.files.importfiles,function(e,a){if(a.error){c(t.language.phrase("ImportMessageUploadError").replace("%f",a.name).replace("%s",a.error),"text-danger");n=false}});if(n)w(i.result.filetoken)}},change:function(e,t){p()},processfail:function(a,i){e.each(i.files,function(e,a){if(a.error)c(t.language.phrase("ImportMessageUploadError").replace("%f",a.name).replace("%s",a.error),"text-danger")})},fail:function(e,a){c(t.language.phrase("ImportMessageServerError").replace("%s",a.textStatus).replace("%t",a.errorThrown),"text-danger")},progressall:function(e,t){m(t)}},T))}i.modal("hide").find(".modal-title").html(a.hdr);i.find(".modal-footer .ew-close-btn").off("click.ew").on("click.ew",function(){var t=e(this);if(t.data("imported")){t.data("imported",false);window.location.reload(true)}});t.importDialog=i.modal("show")}function Be(a){var i=r(a).$element[0];if(!i)return;var n=me(a);var s=Ee(a);var l="",o="",d=s.match(/^([xy])(\d*)_/);if(d){l=d[1];o=d[2]}var f=s.replace(/^([xy])(\d*)_/,"x_");var u=r(a).lists[f];var c=u.autoFillTargetFields;var p=function(t){var n=t.records||"";var l=n?n[0]:[];for(var d=0;d<c.length;d++){var f=de(c[d].replace(/^x_/,"x"+o+"_"),i);if(f){var u=e.isValue(l["af"+d])?l["af"+d]:"";var p={results:n,result:l,data:u,form:i,name:s,target:c[d],cancel:false,trigger:true};e(a).trigger("autofill",[p]);if(p.cancel)continue;u=p.data;if(f.options||f.length&&f[0].type=="radio"){Oe(f,u.split(","))}else if(f.length&&f[0].type=="checkbox"){Oe(f,u.split(","))}else if(F(f)){f.value=u;B(f).input.value=u;S.call(r[i.id],f)}else if($(f)){f.value=u;S.call(r[i.id],f)}else if(U(f)){f.value=u;e(f).data("editor").set()}else{f.value=u}if(p.trigger)e(f).change()}}};if(n.length>0&&n[0]!=""){var h=e.extend(true,{},u,{template:null,options:null,ajax:"autofill",v0:n[0],token:t.ANTIFORGERY_TOKEN,language:t.LANGUAGE_ID},T("#p_"+s,i));var g=[];var m=u.parentFields.slice();if(o!=""){for(var v=0,_=m.length;v<_;v++){var n=m[v].split(" ");if(n.length==1)m[v]=m[v].replace(/^x_/,"x"+o+"_")}}if(m.length>0){for(var v=0,_=m.length;v<_;v++)g.push(me(m[v],i))}for(var v=0,E=g.length;v<E;v++)h["v"+(v+1)]=encodeURIComponent(g[v].join(t.LOOKUP_FILTER_VALUE_SEPARATOR));h[t.API_ACTION_NAME]=t.API_LOOKUP_ACTION;e.post(t.API_URL,h,p,"json")}else{p()}}function He(a,i){var n=e(i),r=e("#"+n.data("tooltip-id")),s=n.data("trigger")||"hover",l=n.data("placement")||(t.CSS_FLIP?"left":"right");if(!r[0]||r.text().trim()==""&&!r.find("img[src!='']")[0])return;if(!n.data("bs.popover")){n.popover({html:true,placement:l,trigger:s,delay:100,container:e("#ew-tooltip")[0],content:r.html()}).on("show.bs.popover",function(t){var a,i=e(n.data("bs.popover").getTipElement()).css("z-index",9999);if(a=n.data("tooltip-width"))i.css("max-width",parseInt(a,10)+"px")})}}function je(a){var i=t.emailDialog||e("#ew-email-dialog");if(!i[0]){H("DIV #ew-email-dialog not found.");return}if(a.sel&&!V(a.f)){H(t.language.phrase("NoRecordSelected"));return}var n=i.find(".modal-body form");var r=n.data("form");if(!r){r=new v(n.attr("id"));r.validate=function(){var e,a=this.getForm();e=a.elements["sender"];if(e&&!Y(e))return this.onError(e,t.language.phrase("EnterSenderEmail"));if(e&&!pt(e.value,1))return this.onError(e,t.language.phrase("EnterProperSenderEmail"));e=a.elements["recipient"];if(e&&!Y(e))return this.onError(e,t.language.phrase("EnterRecipientEmail"));if(e&&!pt(e.value,t.MAX_EMAIL_RECIPIENT))return this.onError(e,t.language.phrase("EnterProperRecipientEmail"));e=a.elements["cc"];if(e&&!pt(e.value,t.MAX_EMAIL_RECIPIENT))return this.onError(e,t.language.phrase("EnterProperCcEmail"));e=a.elements["bcc"];if(e&&!pt(e.value,t.MAX_EMAIL_RECIPIENT))return this.onError(e,t.language.phrase("EnterProperBccEmail"));e=a.elements["subject"];if(e&&!Y(e))return this.onError(e,t.language.phrase("EnterSubject"));return true};r.submit=function(){if(!this.validate())return false;var t=n.serialize(),r="";if(a.f&&a.sel)r=e(a.f).find("input[type=checkbox][name='key_m[]']:checked").serialize();if(a.key)t+="&"+e.param(a.key);var s=this.getForm();if(a.url){i.modal("hide");D(a.f,a.url,"email",true,a.sel,s)}else{e.post(e(a.f).attr("action"),t+"&"+r,function(e){vt(e)})}return true};n.data("form",r)}i.modal("hide").find(".modal-title").html(a.hdr);i.find(".modal-footer .btn-primary").unbind().click(function(e){e.preventDefault();if(r.submit())i.modal("hide")});t.emailDialog=i.modal("show")}function Ge(a,i){if(!e.isObject(a))return undefined;var n=e.extend({token:t.ANTIFORGERY_TOKEN},a);var r=function(t){if(e.isObject(t)&&t.result=="OK"){var a=t.records;if(e.isArray(a)&&a.length==1){a=a[0];if(e.isArray(a)&&a.length==1)return a[0];else return a}return a}};if(e.isFunction(i)){e.post(t.API_URL,n,function(e){i(r(e))},"json")}else{var s=e.ajax({url:t.API_URL,async:false,type:"POST",data:n}).responseText;s=e.parseJSON(s);return r(s)}}function Ye(){return location.href.split("#")[0].split("?")[0]}function We(e,t){var a=this.form.elements[e];if(!a)return;a.value=a.value!=t?t:"="}function ze(e){return Ze(e,"us",t.DATE_SEPARATOR)}function Ve(e){return Ze(e,"usshort",t.DATE_SEPARATOR)}function Ke(e){return Ze(e,"std",t.DATE_SEPARATOR)}function Xe(e){return Ze(e,"stdshort",t.DATE_SEPARATOR)}function qe(e){return Ze(e,"euro",t.DATE_SEPARATOR)}function Je(e){return Ze(e,"euroshort",t.DATE_SEPARATOR)}function Qe(e){if(t.DATE_FORMAT.match(/^yyyy/))return Ke(e);else if(t.DATE_FORMAT.match(/^yy/))return Xe(e);else if(t.DATE_FORMAT.match(/^m/)&&t.DATE_FORMAT.match(/yyyy$/))return ze(e);else if(t.DATE_FORMAT.match(/^m/)&&t.DATE_FORMAT.match(/yy$/))return Ve(e);else if(t.DATE_FORMAT.match(/^d/)&&t.DATE_FORMAT.match(/yyyy$/))return qe(e);else if(t.DATE_FORMAT.match(/^d/)&&t.DATE_FORMAT.match(/yy$/))return Je(e);return false}function Ze(e,t,a){if(!e||e.length=="")return true;e=e.replace(/ +/g," ");e=e.replace(/^\s*|\s*$/g,"");var i=e.split(" ");if(i.length>0){var n,r,s,l,o;n=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1])$/;if(r=n.exec(i[0])){s=r[1];l=r[2];o=r[3]}else{var d="\\"+a;switch(t){case"std":n=new RegExp("^(\\d{4})"+d+"([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"stdshort":n=new RegExp("^(\\d{2})"+d+"([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"us":n=new RegExp("^([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"(\\d{4})$");break;case"usshort":n=new RegExp("^([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"(\\d{2})$");break;case"euro":n=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"([0]?[1-9]|[1][0-2])"+d+"(\\d{4})$");break;case"euroshort":n=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"([0]?[1-9]|[1][0-2])"+d+"(\\d{2})$");break}if(!n.test(i[0]))return false;var f=i[0].split(a);switch(t){case"std":case"stdshort":s=et(f[0]);l=f[1];o=f[2];break;case"us":case"usshort":s=et(f[2]);l=f[0];o=f[1];break;case"euro":case"euroshort":s=et(f[2]);l=f[1];o=f[0];break}}if(!tt(s,l,o))return false}if(i.length>1&&!ot(i[1]))return false;return true}function et(e){if(e.length==2)return e>t.UNFORMAT_YEAR?"19"+e:"20"+e;return e}function tt(e,t,a){e=parseInt(e,10);t=parseInt(t,10);a=parseInt(a,10);var i=[4,6,9,11].includes(t)?30:31;if(t==2)i=e%4>0||e%100==0&&e%400>0?28:29;return lt(a,1,i)}function at(e){if(!e||e.length==0)return true;if(e.indexOf(t.DECIMAL_POINT)>-1)return false;return it(e)}function it(e){e=String(e);if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var a=new RegExp("^[+-]?(\\d{1,3}("+(t.THOUSANDS_SEP?"\\"+t.THOUSANDS_SEP+"?":"")+"\\d{3})*(\\"+t.DECIMAL_POINT+"\\d+)?|\\"+t.DECIMAL_POINT+"\\d+)$");return a.test(e)}function nt(e){e=String(e);if(t.THOUSANDS_SEP!=""){var a=new RegExp("\\"+t.THOUSANDS_SEP,"g");e=e.replace(a,"")}if(t.DECIMAL_POINT!="")e=e.replace(t.DECIMAL_POINT,".");return parseFloat(e)}function rt(e){var t=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1]) (?:(0\d|1\d|2[0-3]):([0-5]\d):([0-5]\d))?$/;var a=e.replace(t,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(a[0],a[1]-1,a[2],a[3],a[4],a[5])}function st(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function lt(t,a,i){if(!t||t.length==0)return true;if(e.isNumber(a)||e.isNumber(i)){if(it(t))t=nt(t)}if(!e.isNull(a)&&t<a)return false;if(!e.isNull(i)&&t>i)return false;return true}function ot(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var a=new RegExp("^(0\\d|1\\d|2[0-3])"+st(t.TIME_SEPARATOR)+"[0-5]\\d(( ("+st(t.language.phrase("AM"))+"|"+st(t.language.phrase("PM"))+"))|("+st(t.TIME_SEPARATOR)+"[0-5]\\d(\\.\\d+)?)?)$","i");return a.test(e)}function dt(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/;return t.test(e)}function ft(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\d{5}$|^\d{5}-\d{4}$/;return t.test(e)}function ut(e){if(!e||e.length==0)return true;var t=e.replace(/\D/g,"");if(t.length==0)return false;var a=t.length%2==1?false:true;var i,n=0;for(var r=0,s=t.length;r<s;r++){i=parseInt(t.charAt(r),10);if(a){i*=2;n+=i%10;if(i/10>=1)n++;a=false}else{n+=i;a=true}}return n%10==0}function ct(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/;return t.test(e)}function pt(e,t){if(!e||e.length==0)return true;var a=e.replace(/,/g,";").split(";");for(var i=0,n=a.length;i<n;i++){if(t>0&&n>t)return false;if(!ht(a[i]))return false}return true}function ht(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i;return t.test(e)}function gt(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}$/;var a=/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/;return t.test(e)||a.test(e)}function mt(e,t){if(!e||e.length==0)return true;return!!e.match(t)}function vt(a){if(window.location!=window.parent.location&&parent.showMessage)return parent.showMessage(a);var i=a&&a.target?a.target:document,n=e(i).find("div.ew-message-dialog:hidden:first"),r=n.find(".alert");e.each(["success","info","warning","danger"],function(e,t){if(r.hasClass("alert-"+t))r.toggleClass("alert-"+t+" text-"+t)});var s=e.isString(a)?a:n.length?t.IS_MOBILE?n.text():n.html():"";if(s.trim()=="")return;if(t.IS_MOBILE){alert(s)}else{var l=e("#ew-message-box");l.find(".modal-body").html(s);l.modal("show")}}function _t(){return Math.floor(Math.random()*100001)+1e5}function Et(a){var i=e(a);if(i.data("blueimpFileupload"))return;var n=i.attr("name"),r=n.replace(/\$/g,"\\$"),s=i.data("table"),l=i.is("[multiple]"),o=i.closest(".form-group,[id^='el_']"),d=o.find(".btn").css("display")=="none"||i.closest("form").find("#confirm").val()=="F",f=o.find("#ft_"+r),u=o.find("#fn_"+r),c=o.find("#fa_"+r),p=o.find("#fs_"+r),h=o.find("#fx_"+r),g=o.find("#fm_"+r),m=o.find("#fc_"+r);var v=function(e,a){if(a.result.files[0].error)return;var i=a.result.files[0].name;var n=l?u.val()?u.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[]:[];n[n.length]=i;u.val(n.join(t.MULTIPLE_UPLOAD_SEPARATOR));c.val("0");if(!l)f.find("tr:not(:last)").remove()};var _=function(a,i){var n={},r=e(a.originalEvent.target).data("url");if(r)r.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,a){if(t)n[t]=a});var s=n["id"];if(s&&n[s]){var l=n[s];var o=u.val()?u.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[];e.each(o,function(e,t){if(t==decodeURIComponent(l)){o.splice(e,1);return false}});u.val(o.join(t.MULTIPLE_UPLOAD_SEPARATOR));c.val("0")}};var E=function(a,i){var n=u.val()?u.val().split(t.MULTIPLE_UPLOAD_SEPARATOR):[];for(var r=0;r<i.files.length;r++)n[n.length]=i.files[r].name;var s=parseInt(m.val(),10);if(e.isNumber(s)&&s>0&&n.length>s){H(t.language.phrase("UploadErrMsgMaxNumberOfFiles"));return false}var l=parseInt(p.val(),10);if(e.isNumber(l)&&l>0&&n.join(t.MULTIPLE_UPLOAD_SEPARATOR).length>l){H(t.language.phrase("UploadErrMsgMaxFileLength"));return false}};var A=function(e){if(!l&&u.val()){if(!confirm(t.language.phrase("UploadOverwrite"))){e.preventDefault();e.stopPropagation()}}};var w=function(a){var i=e();e.each(a.files,function(n,r){var s=e('<tr class="template-upload">'+'<td class="preview"></td>'+'<td class="name"></td>'+'<td class="size"></td>'+(r.error?'<td class="error text-danger" colspan="2"></td>':'<td><div class="progress">'+'<div class="progress-bar bg-success" style="width: 0%;"></div></div></td>'+'<td><button type="button" class="btn btn-default btn-sm start">'+t.language.phrase("UploadStart")+"</button></td>")+'<td><button type="button" class="btn btn-default btn-sm cancel">'+t.language.phrase("UploadCancel")+"</button></td></tr>");s.find(".name").text(r.name);s.find(".size").text(a.formatFileSize(r.size));s.find(".start").click(A);s.find(".error").text(r.error);i=i.add(s)});return i};var S=function(a){var i=e();e.each(a.files,function(n,r){var s=e('<tr class="template-download">'+(r.error?'<td></td><td class="name"></td>'+'<td class="size"></td><td class="error text-danger" colspan="2"></td>':'<td class="preview"></td>'+'<td class="name"><a></a></td>'+'<td class="size"></td><td colspan="2"></td>')+(d?"":'<td><button type="button" class="btn btn-default btn-sm delete">'+t.language.phrase("UploadDelete")+"</button></td>")+"</tr>");s.find(".size").text(a.formatFileSize(r.size));if(r.error){s.find(".name").text(r.name);s.find(".error").text(r.error);if(!r.deleteUrl)s.find(".delete").click(function(){e(this).closest(".template-download").remove();T()})}else{var l=s.find(".name a").text(r.name);if(r.url)l.attr("href",r.url).attr("target","_blank");if(r.thumbnailUrl&&/\.(bmp|gif|jpe?g|png)$/i.test(r.name)){if(t.USE_COLORBOX)l.colorbox(t.lightboxSettings);s.find(".preview").append('<img style="width: '+t.UPLOAD_THUMBNAIL_WIDTH+'px;">').find("img").prop("src",r.thumbnailUrl)}else if(r.url&&/\.(mp4)$/i.test(r.name)){s.find(".preview").append('<video style="width: '+t.UPLOAD_THUMBNAIL_WIDTH+'px;" controls><source type="video/mp4"></video>').find("source").prop("src",r.url)}else if(r.url&&/\.(mp3)$/i.test(r.name)){s.find(".preview").append('<audio style="width: '+t.UPLOAD_THUMBNAIL_WIDTH+'px;" controls><source type="audio/mpeg"></audio>').find("source").prop("src",r.url)}s.find(".delete").attr("data-type",r.deleteType).attr("data-url",r.deleteUrl)}i=i.add(s)});return i};var T=function(){f.css("margin-top",f.find("tr")[0]&&!d?"10px":"0")};var I=function(){i.closest("span.fileinput-button").tooltip("hide")};var O=function(e,t){if(t.files&&t.files.error)H(t.files[0].error)};var y=b(a),x=e(y);var L=x.find("#confirm").val()=="F";if(L)x.find("span.fileinput-button").hide();var C=parseInt(m.val(),10);var R=t.UPLOAD_URL;var N={id:n,table:s,session:t.SESSION_ID,replace:l?"0":"1",exts:h.val(),maxsize:g.val(),maxfilecount:m.val()};N[t.API_ACTION_NAME]=t.API_JQUERY_UPLOAD_ACTION;if(pe(t.UPLOAD_TYPE,"PUT"))R+="?"+e.param(N);i.fileupload({url:R,type:t.UPLOAD_TYPE,multipart:pe(t.UPLOAD_TYPE,"POST"),autoUpload:true,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,loadVideoFileTypes:/^video\/(mp4)$/i,loadAudioFileTypes:/^audio\/(mpeg)$/i,acceptFileTypes:h.val()?new RegExp("\\.("+h.val().replace(/,/g,"|")+")$","i"):null,maxFileSize:parseInt(g.val(),10),maxNumberOfFiles:C>1?C:null,filesContainer:f,formData:N,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:w,downloadTemplate:S,previewMaxWidth:t.UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:t.UPLOAD_THUMBNAIL_HEIGHT,dropZone:o,pasteZone:o,messages:{acceptFileTypes:t.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:t.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:t.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:t.language.phrase("UploadErrMsgMinFileSize")}}).on("fileuploaddone",v).on("fileuploaddestroy",_).on("fileuploadchange",E).on("fileuploadadded fileuploadfinished fileuploaddestroyed",T).on("fileuploadprocessfail",O).click(I);if(u.val()){var P={id:n,table:s,session:t.SESSION_ID};P[t.API_ACTION_NAME]=t.API_JQUERY_UPLOAD_ACTION;e.ajax({url:R,data:P,dataType:"json",context:this,success:function(t){if(t&&t[n]){var r=i.fileupload("option","done");if(r)r.call(a,e.Event(),{result:{files:t[n]}})}if(L)f.find("td.delete").hide()}})}}function bt(a,i){if(e.isString(a)){i=i||{thousandsSeparator:t.THOUSANDS_SEP,decimalSeparator:t.DECIMAL_POINT};var n=[],r,s=i.thousandsSeparator,l=i.decimalSeparator;if(s)n.push(s.replace(/[\-$\^*()+\[\]{}|\\,.?\s]/g,"\\$&")+"(?=\\d)");r=new RegExp("(?:"+n.join("|")+")","g");if(l===".")l=null;a=a.replace(r,"");a=l?a.replace(l,"."):a}if(e.isString(a)&&a.trim()!=="")a=+a;if(!e.isNumber||!isFinite(a))a=null;return a}function At(a,i){if(e.isNumber(a)){i=i||{thousandsSeparator:t.THOUSANDS_SEP,decimalSeparator:t.DECIMAL_POINT};var n=a<0,r=a+"",s=i.decimalPlaces,l=i.decimalSeparator||".",o=i.thousandsSeparator,d,f,u,c;if(e.isNumber(s)&&s>=0&&s<=20)r=a.toFixed(s);if(l!==".")r=r.replace(".",l);if(o){d=r.lastIndexOf(l);d=d>-1?d:r.length;f=r.substring(d);for(u=0,c=d;c>0;c--){if(u%3===0&&c!==d&&(!n||c>1))f=o+f;f=r.charAt(c-1)+f;u++}r=f}return r}else{return e.isValue(a)&&a.toString?a.toString():""}}function wt(a,i){var n=e.makeArray(arguments);if(e.isNumber(i)&&i>=0&&i<=17){var r,s=t.DATE_FORMAT.toUpperCase(),l=t.DATE_SEPARATOR,o=t.TIME_SEPARATOR;switch(i){case 0:case 1:case 2:case 8:r=s+" HH"+o+"mm"+o+"ss";break;case 3:r="hh:mm:ss A";break;case 4:r="HH:mm:ss";break;case 5:r="YYYY"+l+"MM"+l+"DD";break;case 6:r="MM"+l+"DD"+l+"YYYY";break;case 7:r="DD"+l+"MM"+l+"YYYY";break;case 9:r="YYYY"+l+"MM"+l+"DD HH"+o+"mm"+o+"ss";break;case 10:r="MM"+l+"DD"+l+"YYYY HH"+o+"mm"+o+"ss";break;case 11:r="DD"+l+"MM"+l+"YYYY HH"+o+"mm"+o+"ss";break;case 12:r="YY"+l+"MM"+l+"DD";break;case 13:r="MM"+l+"DD"+l+"YY";break;case 14:r="DD"+l+"MM"+l+"YY";break;case 15:r="YY"+l+"MM"+l+"DD HH"+o+"mm"+o+"ss";break;case 16:r="MM"+l+"DD"+l+"YY HH"+o+"mm"+o+"ss";break;case 17:r="DD"+l+"MM"+l+"YY HH"+o+"mm"+o+"ss";break}n[1]=[r,"YYYY-MM-DD HH"+o+"mm"+o+"ss"]}return moment.apply(this,n)}function St(e,a){return moment(e).format(a||t.DATE_FORMAT.toUpperCase())}function Tt(a){x(a);_(a);m(a);d(a);o(a);g(a);var i=a&&a.target?a.target:document,n=e(i);n.find("[data-widget='treeview']").each(function(){adminlte.Treeview._jQueryInterface.call(e(this),"init")});n.find("table."+t.TABLE_CLASSNAME+":not(.ew-export-table):not(#"+t.REPORT_CONTAINER_ID+" table)").each(ae);n.find("table."+t.GRID_CLASSNAME+":not(.ew-export-table):not(#"+t.REPORT_CONTAINER_ID+" table)").each(ie);n.find(".ew-btn-dropdown").on("shown.bs.dropdown",function(){var t=e(this).removeClass("dropup"),a=e(window);$menu=t.find("> .dropdown-menu");t.toggleClass("dropup",$menu.offset().top+$menu.height()>a.scrollTop()+a.height())});n.find("input[name=pageno]").keypress(function(e){if(e.which==13){var t=window.location.href,a=t.lastIndexOf(window.location.search);window.location=t.substr(0,a)+"?"+this.name+"="+parseInt(this.value);return false}});if(!t.IS_SCREEN_SM_MIN){n.find(".table-responsive [data-toggle='dropdown']").parent().on("shown.bs.dropdown",function(){var a=e(this),i=a.find(".dropdown-menu"),n=a.closest(".table-responsive")[0];if(n.scrollHeight-n.clientHeight){var r=i.offset().top+i.outerHeight()-e(n).offset().top-n.clientHeight;if(r>0)i.css(t.CSS_FLIP?"right":"left","100%").css("top",parseFloat(i.css("top"))-r)}})}h(a);u(a);c(a);if(typeof t.USE_JAVASCRIPT_MESSAGE!="undefined"&&t.USE_JAVASCRIPT_MESSAGE)vt(a)}function It(){var t=e(".main-sidebar > .sidebar");t.slimScroll({height:t.height()})}e(window).off("load.lte.treeview");var Ot=adminlte.Layout,yt,xt;function Lt(){if(!yt)yt=e(".wrapper");return yt}function Ct(){return Lt().prop("offsetHeight")>Lt().prop("clientHeight")}function Rt(){return Lt().prop("offsetWidth")>Lt().prop("clientWidth")}function Nt(){e("html").css("overflow-y",Rt()?"hidden":"auto")}if(!t.RESET_HEIGHT){Ot.prototype._fixLayoutHeight=Ot.prototype.fixLayoutHeight;Ot.prototype.__init=Ot.prototype._init;Ot.prototype.fixLayoutHeight=function(){var t=e(".main-sidebar").css("height","auto"),a=e(".content-wrapper").css("height","auto"),i=e(".main-footer").removeClass("show"),n={window:e(window).height(),header:e(".main-header").outerHeight(),footer:i.outerHeight(),sidebar:t.height()},r=this._max(n),s=r-n.header-n.footer,l=a.height();a.css("min-height",s);if(l<=s)a.css("height",s);var o=Lt().prop("clientHeight");if(Ct()){t.css({"min-height":o,height:o})}else{t.css({"min-height":r-n.header,height:o})}Nt();i.addClass("show")};Ot.prototype._init=function(){this.__init();if(Ct()){e("html, body, .wrapper").css("height","100%");this.fixLayoutHeight()}}}function Pt(){if(xt)xt.cancel();xt=e.later(50,null,function(){if(Ct())e("html, body, .wrapper").css("height","100%");Nt();var t=e("body").data("lte.layout");if(t)t.fixLayoutHeight()})}e(function(){e.views.settings.debugMode(t.DEBUG_ENABLED);f();Tt();e("#ew-modal-dialog").on("load.ew",Tt);e("#ew-add-opt-dialog").on("load.ew",Tt);var a=N("hash");if(a&&a.length)e("html, body").animate({scrollTop:e("#"+a[0]).offset().top},800)});a.on("addoption",function(t,a){var i=a.data;var n=a.parents;for(var r=0,s=n.length;r<s;r++){var l=n[r];if(!l.length)return a.valid=false;var o=i["ff"+(r>0?r+1:"")];if(!e.isUndefined(o)&&!l.includes(String(o)))return a.valid=false}});a.on("show.bs.modal",".modal",function(){var t=9900+10*e(".modal:visible").length;e(this).css("z-index",t);setTimeout(function(){e(".modal-backdrop").not(".modal-stack").css("z-index",t-1).addClass("modal-stack")},0)});a.on("hidden.bs.modal",".modal",function(){e(".modal:visible").length&&e(document.body).addClass("modal-open")});return{IS_MOBILE:i,getAutoSuggestSettings:s,setAutoSuggestSettings:l,forms:r,initIcons:o,initPasswordOptions:d,setSessionTimer:f,initExportLinks:u,initMultiSelectCheckboxes:c,fileDownload:p,lazyLoad:h,initLightboxes:g,initTooltips:m,Form:v,Language:I,prompt:E,getForm:b,hasFormData:A,setSearchType:w,updateOptions:S,getUserParams:T,applyTemplate:O,renderTemplate:y,renderJsTemplates:x,showTemplates:L,convertToBool:C,valueChanged:R,get:N,setLanguage:P,submitAction:M,export:D,removeSpaces:k,isHiddenTextArea:U,isModalLookup:$,isAutoSuggest:F,getAutoSuggest:B,alert:H,onError:j,setFocus:G,hasValue:Y,sort:W,confirmDelete:z,keySelected:V,selectAllKey:K,selectAll:X,updateSelected:q,setColor:J,clearSelected:Q,clearDelete:Z,clickDelete:ee,clickMultiCheckbox:te,setupTable:ae,setupGrid:ie,addGridRow:ne,deleteGridRow:re,htmlEncode:se,clearForm:le,MultiPage:oe,getElements:de,getElement:fe,getAncestorBy:ue,isHidden:ce,sameText:pe,sameString:he,inArray:ge,getOptionValues:me,getOptionTexts:ve,clearOptions:_e,getId:Ee,valueSeparator:be,displayValue:Ae,optionHtml:we,optionsHtml:Se,newOption:Te,renderOption:Ie,selectOption:Oe,AutoSuggest:ye,executeScript:xe,stripScript:Le,addScript:Ce,removeScript:Re,getContent:Ne,saveOptions:Pe,getOptions:Me,addOptionDialogShow:De,modalDialogHide:ke,modalDialogShow:Ue,modalLookupShow:$e,importDialogShow:Fe,autoFill:Be,tooltip:He,emailDialogShow:je,ajax:Ge,currentPage:Ye,toggleSearchOperator:We,checkUSDate:ze,checkShortUSDate:Ve,checkDate:Ke,checkShortDate:Xe,checkEuroDate:qe,checkShortEuroDate:Je,checkDateDef:Qe,checkDateEx:Ze,unformatYear:et,checkDay:tt,checkInteger:at,checkNumber:it,stringToFloat:nt,stringToDate:rt,escapeRegExChars:st,checkRange:lt,checkTime:ot,checkPhone:dt,checkZip:ft,checkCreditCard:ut,checkSsc:ct,checkEmails:pt,checkEmail:ht,checkGuid:gt,checkByRegEx:mt,showMessage:vt,random:_t,upload:Et,parseNumber:bt,formatNumber:At,parseDate:wt,formatDate:St,initSlimScroll:It,fixLayoutHeight:Pt,Layout:Ot}}(jQuery,ew));if(!String.prototype.includes){String.prototype.includes=function(e,t){"use strict";if(typeof t!=="number"){t=0}if(t+e.length>this.length){return false}else{return this.indexOf(e,t)!==-1}}}if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}}if(!String.prototype.endsWith){String.prototype.endsWith=function(e,t){if(!(t<this.length))t=this.length;else t|=0;return this.substr(t-e.length,e.length)===e}}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null){throw new TypeError('"this" is null or not defined')}var a=Object(this);var i=a.length>>>0;if(i===0){return false}var n=t|0;var r=Math.max(n>=0?n:i-Math.abs(n),0);function s(e,t){return e===t||typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}while(r<i){if(s(a[r],e)){return true}r++}return false}})}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e,t){var a;if(this==null){throw new TypeError('"this" is null or not defined')}var i=Object(this);var n=i.length>>>0;if(n===0){return-1}var r=t|0;if(r>=n){return-1}a=Math.max(r>=0?r:n-Math.abs(r),0);while(a<n){if(a in i&&i[a]===e){return a}a++}return-1}}jQuery.extend({isBoolean:function(e){return typeof e==="boolean"},isNull:function(e){return e===null},isNumber:function(e){return typeof e==="number"&&isFinite(e)},isObject:function(e){return e&&(typeof e==="object"||this.isFunction(e))||false},isString:function(e){return typeof e==="string"},isUndefined:function(e){return typeof e==="undefined"},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return this.type(e)==="date"&&e.toString()!=="Invalid Date"&&!isNaN(e)},later:function(e,t,a,i,n){e=e||0;t=t||{};var r=a,s=i,l,o;if(this.isString(a))r=t[a];if(!r)return;if(!this.isUndefined(i)&&!this.isArray(s))s=[i];l=function(){r.apply(t,s||[])};o=n?setInterval(l,e):setTimeout(l,e);return{interval:n,cancel:function(){if(this.interval){clearInterval(o)}else{clearTimeout(o)}}}}});(function(e,t){e.fn.fields=function(a){var i={},n=this.attr("id"),r=this[0],s,l,o;if(/^[xy](\d*)_/.test(n)){s=t.getForm(r);l=this.data("table");o=RegExp.$1}else if(r&&r._form){s=r.$element;l=r.id.replace(new RegExp("^f|"+r.pageId+"$","g"),"");o=e(r._form).data("rowindex")}var d="[data-table="+l+"][data-field"+(a?"=x_"+a:"")+"]";if(e.isValue(o))d+="[name^=x"+o+"_]";if(s&&d){e(s).find(d).each(function(){var t=this.getAttribute("data-field").substr(2),a=this.getAttribute("name");t=/^y_/.test(a)?"y_"+t:t;i[t]=i[t]?i[t].add(this):e(this)})}return a?i[a]:i};e.fn.extend({row:function(){var e=this.closest("#r_"+this.data("field").substr(2));if(!e[0])e=this.closest(".ew-table > tbody > tr");return e},visible:function(e){var t=this.closest("#r_"+this.data("field").substr(2));if(!t[0])t=this.closest("span[id^=el_]");if(typeof e!="undefined"){t.toggle(e);return this}else{return t.is(":visible")}},readonly:function(e){if(typeof e!="undefined"){this.prop("readOnly",e);return this}else{return this.prop("readOnly")}},disabled:function(e){if(typeof e!="undefined"){this.prop("disabled",e);return this}else{return this.prop("disabled")}},value:function(a){var i=this.attr("type");if(typeof a!="undefined"){if(!e.isArray(a))a=[a];var i=this.attr("type");var n=i=="radio"||i=="checkbox"?this.get():this[0];t.selectOption(n,a);return this}else{if(i=="checkbox"){return t.getOptionValues(this.get())}else if(i=="radio"){return t.getOptionValues(this.get()).join()}else if(t.isHiddenTextArea(this)){this.data("editor").save();return this.val()}else{return this.val()}}},toNumber:function(){return t.parseNumber(this.value())},toDate:function(){return t.parseDate(this.value(),this.data("format"))},toJsDate:function(){return t.parseDate(this.value(),this.data("format")).toDate()}})})(jQuery,ew);(function(e,t){e(document).on("click.bs.dropdown.data-api",".ew-dropdown[data-toggle=dropdown]",function(a){var i=a.target.nodeName;var n=e(this).attr("href");if(n&&n!="#"&&window.matchMedia){if(t.IS_SCREEN_SM_MIN||i=="SPAN"){window.location=n}}})})(jQuery,ew);ewVar=ew.vars;